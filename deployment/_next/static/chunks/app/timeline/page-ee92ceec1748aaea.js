(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[404],{2523:(e,t,a)=>{"use strict";a.d(t,{p:()=>l});var r=a(2372),s=a(2115),n=a(9434);let l=s.forwardRef((e,t)=>{let{className:a,type:s,...l}=e;return(0,r.Y)("input",{type:s,className:(0,n.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...l})});l.displayName="Input"},2773:(e,t,a)=>{Promise.resolve().then(a.bind(a,2957))},2957:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>eO});var r=a(2372),s=a(4399),n=a(2115),l=a(285),o=a(4838),d=a(6923),i=a(8718),c=a(9311),m=a(7554),h=a(8027),u=a(5120),p=a(6936),g=a(8271),f=a(8046);function b(e){let{projectName:t,projectDescription:a,onAddTask:s,onExportPNG:n,onExportJSON:b,onImportJSON:x,onRefresh:N,theme:k,resolvedTheme:v,onThemeChange:w,onOpenSettings:y,settings:D}=e;return(0,r.FD)("div",{className:"flex items-center justify-between gap-4 px-4 md:px-6 py-3 bg-stone-50 dark:bg-stone-800 border-b border-stone-200 dark:border-stone-700",children:[(0,r.Y)("div",{className:"md:hidden",children:(0,r.Y)("h2",{className:"text-sm font-semibold text-stone-700 dark:text-white truncate max-w-[150px]",children:t})}),(0,r.FD)("div",{className:"flex items-center gap-2 flex-wrap ml-auto",children:[(0,r.FD)(l.$,{variant:"outline",size:"sm",onClick:x,className:"border-stone-300 dark:border-stone-600 text-stone-600 dark:text-stone-300 hover:bg-stone-100 dark:hover:bg-stone-700",children:[(0,r.Y)(d.A,{className:"w-4 h-4 mr-1.5"}),(0,r.Y)("span",{className:"hidden sm:inline",children:"Import"})]}),(0,r.FD)(l.$,{variant:"outline",size:"sm",onClick:b,className:"border-stone-300 dark:border-stone-600 text-stone-600 dark:text-stone-300 hover:bg-stone-100 dark:hover:bg-stone-700",children:[(0,r.Y)(i.A,{className:"w-4 h-4 mr-1.5"}),(0,r.Y)("span",{className:"hidden sm:inline",children:"Export"})]}),(0,r.FD)(l.$,{variant:"outline",size:"sm",onClick:n,className:"border-stone-300 dark:border-stone-600 text-stone-600 dark:text-stone-300 hover:bg-stone-100 dark:hover:bg-stone-700",children:[(0,r.Y)(c.A,{className:"w-4 h-4 mr-1.5"}),"PNG"]}),(0,r.Y)(l.$,{variant:"outline",size:"sm",onClick:N,className:"border-stone-300 dark:border-stone-600 text-stone-600 dark:text-stone-300 hover:bg-stone-100 dark:hover:bg-stone-700",children:(0,r.Y)(m.A,{className:"w-4 h-4"})}),(0,r.FD)(o.rI,{children:[(0,r.Y)(o.ty,{asChild:!0,children:(0,r.FD)(l.$,{variant:"outline",size:"sm",className:"border-teal-500 dark:border-teal-500 text-teal-600 dark:text-teal-400 hover:bg-teal-50 dark:hover:bg-teal-900/30 gap-1.5",children:["dark"===k?(0,r.Y)(h.A,{className:"w-4 h-4"}):"system"===k?(0,r.Y)(u.A,{className:"w-4 h-4"}):(0,r.Y)(p.A,{className:"w-4 h-4"}),(0,r.Y)("span",{className:"hidden sm:inline text-xs",children:"Theme"})]})}),(0,r.FD)(o.SQ,{align:"end",className:"dark:bg-stone-800 dark:border-stone-700",children:[(0,r.FD)(o._2,{onClick:()=>w("light"),className:"dark:hover:bg-stone-700",children:[(0,r.Y)(p.A,{className:"w-4 h-4 mr-2"}),"Light"]}),(0,r.FD)(o._2,{onClick:()=>w("dark"),className:"dark:hover:bg-stone-700",children:[(0,r.Y)(h.A,{className:"w-4 h-4 mr-2"}),"Dark"]}),(0,r.FD)(o._2,{onClick:()=>w("system"),className:"dark:hover:bg-stone-700",children:[(0,r.Y)(u.A,{className:"w-4 h-4 mr-2"}),"System"]}),y&&(0,r.FD)(r.FK,{children:[(0,r.Y)(o.mB,{className:"dark:bg-stone-700"}),(0,r.FD)(o._2,{onClick:y,className:"dark:hover:bg-stone-700",children:[(0,r.Y)(g.A,{className:"w-4 h-4 mr-2"}),"Settings"]})]})]})]}),(0,r.FD)(l.$,{size:"sm",onClick:s,className:"bg-stone-800 dark:bg-teal-600 hover:bg-stone-900 dark:hover:bg-teal-700 text-white",children:[(0,r.Y)(f.A,{className:"w-4 h-4 mr-1.5"}),"Add Task"]})]})]})}var x=a(6695),N=a(9272),k=a(8376),v=a(7648),w=a(4601),y=a(5263);function D(e){let{tasks:t}=e,a=t.length,s=t.filter(e=>"complete"===e.status).length,n=t.filter(e=>"in-progress"===e.status).length,l=t.filter(e=>e.isMilestone).length,o=t.length>0?Math.round(t.reduce((e,t)=>e+t.progress,0)/t.length):0,d=[{label:"Total Tasks",value:a,icon:N.A,color:"text-stone-600 dark:text-stone-300",bgColor:"bg-stone-50 dark:bg-stone-800 border-stone-200 dark:border-stone-700",iconBg:"bg-stone-100 dark:bg-stone-700"},{label:"Completed",value:s,icon:k.A,color:"text-teal-600 dark:text-teal-400",bgColor:"bg-teal-50 dark:bg-teal-900/30 border-teal-200 dark:border-teal-800",iconBg:"bg-teal-100 dark:bg-teal-800/50"},{label:"In Progress",value:n,icon:v.A,color:"text-orange-600 dark:text-orange-400",bgColor:"bg-orange-50 dark:bg-orange-900/30 border-orange-200 dark:border-orange-800",iconBg:"bg-orange-100 dark:bg-orange-800/50"},{label:"Milestones",value:l,icon:w.A,color:"text-cyan-600 dark:text-cyan-400",bgColor:"bg-cyan-50 dark:bg-cyan-900/30 border-cyan-200 dark:border-cyan-800",iconBg:"bg-cyan-100 dark:bg-cyan-800/50"},{label:"Avg. Progress",value:"".concat(o,"%"),icon:y.A,color:"text-stone-600 dark:text-stone-300",bgColor:"bg-stone-50 dark:bg-stone-800 border-stone-200 dark:border-stone-700",iconBg:"bg-stone-100 dark:bg-stone-700"}];return(0,r.Y)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3 md:gap-4",children:d.map(e=>(0,r.Y)(x.Zp,{className:"p-3 md:p-4 border ".concat(e.bgColor," rounded-xl shadow-sm"),children:(0,r.FD)("div",{className:"flex items-center justify-between",children:[(0,r.FD)("div",{children:[(0,r.Y)("p",{className:"text-xs font-medium ".concat(e.color," opacity-80"),children:e.label}),(0,r.Y)("p",{className:"text-2xl md:text-3xl font-bold ".concat(e.color," mt-0.5"),children:e.value})]}),(0,r.Y)("div",{className:"p-2 rounded-lg ".concat(e.iconBg),children:(0,r.Y)(e.icon,{className:"w-5 h-5 ".concat(e.color)})})]})},e.label))})}var Y=a(2523),F=a(9409),C=a(5074),S=a(5318),A=a(7805);function T(e){let{zoom:t,onZoomChange:a,filter:s,onFilterChange:n,showDependencies:o,onShowDependenciesChange:d,showCriticalPath:i,onShowCriticalPathChange:c,searchQuery:m="",onSearchChange:h}=e;return(0,r.FD)("div",{className:"flex flex-wrap items-center gap-4 px-4 md:px-6 py-3 bg-white dark:bg-stone-800 border-y border-stone-200 dark:border-stone-700",children:[h&&(0,r.Y)("div",{className:"flex items-center gap-2",children:(0,r.FD)("div",{className:"relative",children:[(0,r.Y)(C.A,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-stone-400 dark:text-stone-500"}),(0,r.Y)(Y.p,{type:"text",placeholder:"Search tasks...",value:m,onChange:e=>h(e.target.value),className:"h-8 w-40 md:w-48 pl-8 pr-8 text-xs bg-white dark:bg-stone-700 border-stone-200 dark:border-stone-600 dark:text-white dark:placeholder:text-stone-400 focus:ring-1 focus:ring-stone-300 dark:focus:ring-stone-500"}),m&&(0,r.Y)("button",{type:"button",onClick:()=>h(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-stone-400 hover:text-stone-600 dark:hover:text-stone-300",children:(0,r.Y)(S.A,{className:"w-3.5 h-3.5"})})]})}),(0,r.FD)("div",{className:"flex items-center gap-3",children:[(0,r.Y)("span",{className:"text-xs font-semibold text-stone-500 dark:text-stone-400 uppercase tracking-wide",children:"Zoom:"}),(0,r.Y)("div",{className:"flex bg-white dark:bg-stone-700 rounded-md border border-stone-200 dark:border-stone-600 p-0.5",children:["day","week","month"].map(e=>(0,r.Y)("button",{type:"button",onClick:()=>a(e),className:"px-3 py-1.5 text-xs font-medium rounded transition-colors capitalize ".concat(t===e?"bg-stone-800 dark:bg-teal-600 text-white":"text-stone-600 dark:text-stone-300 hover:bg-stone-100 dark:hover:bg-stone-600"),children:e},e))})]}),(0,r.FD)("div",{className:"flex items-center gap-3",children:[(0,r.Y)("span",{className:"text-xs font-semibold text-stone-500 dark:text-stone-400 uppercase tracking-wide",children:"Filter:"}),(0,r.FD)(F.l6,{value:s,onValueChange:e=>n(e),children:[(0,r.Y)(F.bq,{className:"w-32 h-8 text-xs bg-white dark:bg-stone-700 border-stone-200 dark:border-stone-600 dark:text-white",children:(0,r.Y)(F.yv,{})}),(0,r.FD)(F.gC,{className:"dark:bg-stone-800 dark:border-stone-700",children:[(0,r.Y)(F.eb,{value:"all",children:"All Tasks"}),(0,r.Y)(F.eb,{value:"complete",children:"Complete"}),(0,r.Y)(F.eb,{value:"in-progress",children:"In Progress"}),(0,r.Y)(F.eb,{value:"not-started",children:"Not Started"})]})]})]}),(0,r.Y)("div",{className:"flex-1 hidden md:block"}),(0,r.FD)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,r.FD)(l.$,{variant:"outline",size:"sm",onClick:()=>d(!o),className:"h-8 text-xs border-stone-200 dark:border-stone-600 ".concat(o?"bg-stone-800 dark:bg-teal-600 text-white border-stone-800 dark:border-teal-600 hover:bg-stone-900 dark:hover:bg-teal-700":"bg-white dark:bg-stone-700 text-stone-600 dark:text-stone-300 hover:bg-stone-100 dark:hover:bg-stone-600"),children:[(0,r.Y)(A.A,{className:"w-3.5 h-3.5 mr-1.5"}),"Dependencies"]}),(0,r.FD)(l.$,{variant:"outline",size:"sm",onClick:()=>c(!i),className:"h-8 text-xs border-stone-200 dark:border-stone-600 ".concat(i?"bg-red-600 text-white border-red-600 hover:bg-red-700":"bg-white dark:bg-stone-700 text-stone-600 dark:text-stone-300 hover:bg-stone-100 dark:hover:bg-stone-600"),children:[(0,r.Y)(w.A,{className:"w-3.5 h-3.5 mr-1.5 ".concat(i?"text-white":"")}),"Critical Path"]})]})]})}function j(e,t){return Math.round((t.getTime()-e.getTime())/864e5)}function R(e,t,a){return{left:j(t,new Date(e.startDate))*a,width:Math.max((j(new Date(e.startDate),new Date(e.endDate))+1)*a-4,8)}}var _=a(295),M=a(3158),P=a(9556),L=a(1133),E=a(8082),I=a(9434);let z=E.Kq,J=E.bL,O=E.l9,$=n.forwardRef((e,t)=>{let{className:a,sideOffset:s=4,...n}=e;return(0,r.Y)(E.ZL,{children:(0,r.Y)(E.UC,{ref:t,sideOffset:s,className:(0,I.cn)("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",a),...n})})});$.displayName=E.UC.displayName;var U=a(5143),B=a(402),q=a(8266);function K(e){let{task:t,index:a,isCritical:s,showCriticalPath:n,onTaskClick:l,hasSubtasks:o,isSubtask:d,isCollapsed:i,onToggleCollapse:c}=e,{attributes:m,listeners:h,setNodeRef:u,transform:p,transition:g,isDragging:f}=(0,B.gl)({id:t.id}),b={transform:q.Ks.Transform.toString(p),transition:g};return(0,r.FD)("div",{ref:u,style:b,className:"h-10 px-4 flex items-center gap-2 border-b border-stone-100 dark:border-stone-700 hover:bg-stone-100 dark:hover:bg-stone-600 cursor-pointer transition-colors ".concat(a%2==0?"bg-stone-50 dark:bg-stone-800":"bg-white dark:bg-stone-900"," ").concat(s?"border-l-2 border-l-red-500":""," ").concat(f?"opacity-50 shadow-lg z-50":""," ").concat(d?"pl-10":""),onClick:()=>null==l?void 0:l(t),onKeyDown:e=>"Enter"===e.key&&(null==l?void 0:l(t)),role:"button",tabIndex:0,children:[(0,r.Y)("div",{...m,...h,className:"drag-handle p-1 -m-1 rounded hover:bg-stone-200 dark:hover:bg-stone-600",onClick:e=>e.stopPropagation(),children:(0,r.Y)(_.A,{className:"w-3.5 h-3.5 text-stone-400 dark:text-stone-500 flex-shrink-0"})}),o&&(0,r.Y)("button",{type:"button",onClick:e=>{e.stopPropagation(),null==c||c()},className:"p-0.5 hover:bg-stone-200 dark:hover:bg-stone-600 rounded",children:i?(0,r.Y)(M.A,{className:"w-3.5 h-3.5 text-stone-500"}):(0,r.Y)(P.A,{className:"w-3.5 h-3.5 text-stone-500"})}),(0,r.Y)("span",{className:"text-sm truncate ".concat(s?"text-red-700 dark:text-red-400 font-medium":"text-stone-700 dark:text-stone-200"),children:t.name}),s&&(0,r.Y)(L.A,{className:"w-3.5 h-3.5 text-red-500 flex-shrink-0"})]})}function G(e){let{tasks:t,allTasks:a,zoom:s,filter:l,showDependencies:o,showCriticalPath:d,onTaskClick:i,onReorderTasks:c,projectName:m="Project"}=e,h=(0,n.useRef)(null),u=(0,n.useRef)(null),p=(0,n.useRef)(null),[g,f]=(0,n.useState)(new Set),b=(0,U.FR)((0,U.MS)(U.AN,{activationConstraint:{distance:8}}),(0,U.MS)(U.uN,{coordinateGetter:B.JR})),x=(0,n.useMemo)(()=>{let e=t.filter(e=>!e.parentId),a=new Map;for(let e of t)if(e.parentId){let t=a.get(e.parentId)||[];t.push(e),a.set(e.parentId,t)}return{parentTasks:e,childTasksMap:a}},[t]),N=(0,n.useMemo)(()=>{let e=[],{parentTasks:t,childTasksMap:a}=x;for(let r of t)if(e.push(r),!g.has(r.id)){let t=a.get(r.id)||[];e.push(...t)}return e},[x,g]),k=(0,n.useMemo)(()=>"all"===l?N:N.filter(e=>e.status===l),[N,l]),v=(0,n.useMemo)(()=>d?new Set(function(e){if(0===e.length)return[];let t=new Map;for(let a of e)t.set(a.id,a);let a=e=>j(new Date(e.startDate),new Date(e.endDate))+1,r=new Map,s=new Map;for(let t of e)r.set(t.id,[]),s.set(t.id,t.dependencies||[]);for(let t of e)if(t.dependencies)for(let e of t.dependencies){let a=r.get(e)||[];a.push(t.id),r.set(e,a)}let n=new Map,l=new Map,o=new Set,d=[],i=e=>{if(o.has(e))return;o.add(e);let a=t.get(e);if(null==a?void 0:a.dependencies)for(let e of a.dependencies)t.has(e)&&i(e);d.push(e)};for(let t of e)i(t.id);for(let e of d){let r=t.get(e);if(!r)continue;let o=a(r),d=s.get(e)||[],i=0;for(let e of d)i=Math.max(i,l.get(e)||0);n.set(e,i),l.set(e,i+o)}let c=new Map,m=new Map,h=0;for(let e of l.values())h=Math.max(h,e);for(let e=d.length-1;e>=0;e--){let s=d[e],n=t.get(s);if(!n)continue;let l=a(n),o=r.get(s)||[],i=h;for(let e of o){let t=c.get(e);void 0!==t&&(i=Math.min(i,t))}m.set(s,i),c.set(s,i-l)}let u=[];for(let t of e){let e=n.get(t.id)||0;0==(c.get(t.id)||0)-e&&u.push(t.id)}return u}(a||t)):new Set,[a,t,d]),{start:w,end:y}=(0,n.useMemo)(()=>(function(e){if(0===e.length){let e=new Date;return{start:new Date(e.getFullYear(),e.getMonth()-1,1),end:new Date(e.getFullYear(),e.getMonth()+2,0)}}let t=new Date(e[0].startDate),a=new Date(e[0].endDate);for(let r of e)new Date(r.startDate)<t&&(t=new Date(r.startDate)),new Date(r.endDate)>a&&(a=new Date(r.endDate));return{start:t=new Date(t.getFullYear(),t.getMonth(),1),end:a=new Date(a.getFullYear(),a.getMonth()+1,15)}})(a||t),[a,t]),D=function(e){switch(e){case"day":return 40;case"week":default:return 20;case"month":return 8}}(s),Y=j(w,y),F=Y*D,C=(0,n.useMemo)(()=>j(w,new Date)*D+D/2,[w,D]),S=(0,n.useMemo)(()=>{let e=[],t=new Date(w);for(;t<=y;){let a=new Date(t.getFullYear(),t.getMonth(),1),r=new Date(t.getFullYear(),t.getMonth()+1,0),s=a<w?w:a,n=r>y?y:r,l=j(w,s),o=j(s,n)+1;e.push({name:t.toLocaleDateString("en-US",{month:"short"}),year:t.getFullYear(),startDay:l,days:o}),t.setMonth(t.getMonth()+1)}return e},[w,y]),A=(0,n.useMemo)(()=>{let e=[],t=new Date(w),a=0;for(;t<=y;)("day"===s||"week"===s&&a%7==0||"month"===s&&1===t.getDate())&&e.push({day:t.getDate(),position:a*D}),t.setDate(t.getDate()+1),a++;return e},[w,y,s,D]),T=C>=0&&C<=F,_=(0,n.useCallback)(()=>{h.current&&u.current&&(u.current.scrollTop=h.current.scrollTop)},[]),M=(0,n.useCallback)(()=>{h.current&&u.current&&p.current&&(h.current.scrollTop=u.current.scrollTop,p.current.scrollLeft=u.current.scrollLeft)},[]);(0,n.useEffect)(()=>{if(u.current&&p.current&&k.length>0){let{left:e}=R(k[0],w,D),t=Math.max(0,e-50);u.current.scrollLeft=t,p.current.scrollLeft=t}},[k,w,D]);let P=d?v.size:0,E=e=>{f(t=>{let a=new Set(t);return a.has(e)?a.delete(e):a.add(e),a})};return(0,r.Y)(z,{delayDuration:200,children:(0,r.FD)("div",{className:"flex flex-col h-full bg-stone-800 dark:bg-stone-900 rounded-b-xl overflow-hidden",children:[(0,r.FD)("div",{className:"flex items-center justify-between px-4 py-3 bg-stone-800 dark:bg-stone-900 border-b border-stone-700",children:[(0,r.FD)("div",{children:[(0,r.Y)("h2",{className:"text-lg font-semibold text-white",children:m}),(0,r.FD)("p",{className:"text-sm text-stone-400",children:[k.length," of ",(a||t).length," tasks",d&&P>0&&(0,r.FD)("span",{className:"ml-2 text-red-400",children:["(",P," critical)"]})]})]}),(0,r.FD)("div",{className:"flex items-center gap-4 text-xs",children:[(0,r.FD)("div",{className:"flex items-center gap-1.5",children:[(0,r.Y)("span",{className:"w-2.5 h-2.5 rounded-full bg-teal-500"}),(0,r.Y)("span",{className:"text-stone-300",children:"Complete"})]}),(0,r.FD)("div",{className:"flex items-center gap-1.5",children:[(0,r.Y)("span",{className:"w-2.5 h-2.5 rounded-full bg-orange-500"}),(0,r.Y)("span",{className:"text-stone-300",children:"In Progress"})]}),(0,r.FD)("div",{className:"flex items-center gap-1.5",children:[(0,r.Y)("span",{className:"w-2.5 h-2.5 rounded-full bg-rose-400"}),(0,r.Y)("span",{className:"text-stone-300",children:"Not Started"})]}),d&&(0,r.FD)("div",{className:"flex items-center gap-1.5",children:[(0,r.Y)("span",{className:"w-2.5 h-2.5 rounded ring-2 ring-red-500 ring-offset-1 ring-offset-stone-800"}),(0,r.Y)("span",{className:"text-stone-300",children:"Critical"})]})]})]}),(0,r.FD)("div",{className:"flex flex-1 overflow-hidden",children:[(0,r.FD)("div",{className:"w-64 md:w-80 flex-shrink-0 bg-stone-50 dark:bg-stone-800 border-r border-stone-200 dark:border-stone-700 flex flex-col",children:[(0,r.Y)("div",{className:"h-[72px] px-4 flex items-end pb-2 bg-stone-100 dark:bg-stone-800 border-b border-stone-200 dark:border-stone-700 flex-shrink-0",children:(0,r.Y)("span",{className:"text-xs font-medium text-stone-500 dark:text-stone-400 uppercase tracking-wide",children:"Task Name"})}),(0,r.Y)("div",{ref:h,className:"flex-1 overflow-y-auto overflow-x-hidden",onScroll:_,children:(0,r.Y)(U.Mp,{sensors:b,collisionDetection:U.fp,onDragEnd:e=>{let{active:t,over:a}=e;if(a&&t.id!==a.id){let e=k.findIndex(e=>e.id===t.id),r=k.findIndex(e=>e.id===a.id),s=(0,B.be)(k,e,r);null==c||c(s)}},children:(0,r.Y)(B.gB,{items:k.map(e=>e.id),strategy:B._G,children:k.map((e,t)=>{let a=d&&v.has(e.id),s=x.childTasksMap.has(e.id),n=!!e.parentId;return(0,r.Y)(K,{task:e,index:t,isCritical:a,showCriticalPath:d,onTaskClick:i,hasSubtasks:s,isSubtask:n,isCollapsed:g.has(e.id),onToggleCollapse:()=>E(e.id)},e.id)})})})})]}),(0,r.FD)("div",{className:"flex-1 overflow-hidden flex flex-col min-w-0",children:[(0,r.Y)("div",{ref:p,className:"h-[72px] bg-stone-100 dark:bg-stone-800 border-b border-stone-200 dark:border-stone-700 relative flex-shrink-0 overflow-x-hidden",children:(0,r.FD)("div",{style:{width:F,minWidth:"100%"},className:"h-full relative",children:[(0,r.Y)("div",{className:"h-9 flex items-center border-b border-stone-200 dark:border-stone-700",children:S.map((e,t)=>(0,r.FD)("div",{className:"flex items-center justify-center text-xs font-medium text-stone-600 dark:text-stone-300 border-r border-stone-200 dark:border-stone-700 h-full flex-shrink-0",style:{width:e.days*D},children:[e.name," ",e.year]},"".concat(e.name,"-").concat(e.year,"-").concat(t)))}),(0,r.FD)("div",{className:"h-[36px] relative",children:[A.map((e,t)=>(0,r.Y)("div",{className:"absolute top-0 h-full flex items-center justify-center text-[10px] text-stone-500 dark:text-stone-400",style:{left:e.position,width:"week"===s?7*D:D},children:e.day},"day-".concat(t))),T&&(0,r.Y)("div",{className:"absolute top-0 h-full flex flex-col items-center z-20",style:{left:C-20},children:(0,r.Y)("div",{className:"bg-orange-500 text-white text-[10px] px-1.5 py-0.5 rounded font-medium",children:"TODAY"})})]})]})}),(0,r.Y)("div",{ref:u,className:"flex-1 overflow-auto bg-stone-50 dark:bg-stone-800",onScroll:M,children:(0,r.FD)("div",{className:"relative",style:{width:F,minWidth:"100%",height:40*k.length},children:[Array.from({length:Math.ceil(Y/("week"===s?7:1))}).map((e,t)=>(0,r.Y)("div",{className:"absolute top-0 bottom-0 border-l border-stone-200 dark:border-stone-700",style:{left:t*D*("week"===s?7:1)}},"grid-".concat(t))),T&&(0,r.Y)("div",{className:"absolute top-0 bottom-0 w-0.5 bg-orange-500 z-10",style:{left:C}}),k.map((e,t)=>{let{left:a,width:s}=R(e,w,D),n=s*e.progress/100,l=d&&v.has(e.id),o=s>40,c=!!e.parentId;return(0,r.FD)("div",{className:"absolute flex items-center",style:{top:40*t,height:40,left:0,right:0},children:[(0,r.Y)("div",{className:"absolute inset-0 ".concat(t%2==0?"bg-stone-50 dark:bg-stone-800":"bg-white dark:bg-stone-900"," border-b border-stone-100 dark:border-stone-700")}),(0,r.FD)(J,{children:[(0,r.Y)(O,{asChild:!0,children:(0,r.FD)("div",{className:"absolute h-6 rounded-md ".concat(function(e){switch(e){case"complete":return"bg-teal-200";case"in-progress":return"bg-amber-200";case"not-started":return"bg-stone-200 dark:bg-stone-600";default:return"bg-gray-200"}}(e.status)," cursor-pointer hover:opacity-90 transition-all overflow-hidden shadow-sm border ").concat("not-started"===e.status?"border-stone-400 dark:border-stone-500":"border-transparent"," ").concat(l?"ring-2 ring-red-500 ring-offset-1":""," ").concat(c?"h-5":""),style:{left:a+4,width:s},onClick:()=>null==i?void 0:i(e),onKeyDown:t=>"Enter"===t.key&&(null==i?void 0:i(e)),role:"button",tabIndex:0,children:[(0,r.Y)("div",{className:"h-full ".concat(function(e){switch(e){case"complete":return"bg-teal-500";case"in-progress":return"bg-orange-500";case"not-started":return"bg-rose-400";default:return"bg-gray-400"}}(e.status)," ").concat(e.progress<100?"rounded-l-md":"rounded-md"," ").concat(0===e.progress?"opacity-0":""),style:{width:0===e.progress?"100%":n}}),o&&e.progress>50&&(0,r.FD)("span",{className:"absolute inset-0 flex items-center justify-center text-[10px] font-semibold text-stone-800 dark:text-stone-900",children:[e.progress,"%"]}),o&&0===e.progress&&(0,r.Y)("span",{className:"absolute inset-0 flex items-center justify-center text-[10px] font-medium text-stone-500 dark:text-stone-400",children:"0%"})]})}),(0,r.Y)($,{side:"top",className:"bg-stone-900 text-white border-stone-700 px-3 py-2 max-w-xs",children:(0,r.FD)("div",{className:"space-y-1",children:[(0,r.Y)("p",{className:"font-semibold text-sm",children:e.name}),(0,r.FD)("div",{className:"text-xs text-stone-300 space-y-0.5",children:[(0,r.Y)("p",{children:function(e,t){let a=new Date(e).toLocaleDateString("en-GB",{day:"numeric",month:"short"}),r=new Date(t).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"});return"".concat(a," - ").concat(r)}(e.startDate,e.endDate)}),(0,r.FD)("p",{children:["Duration: ",function(e){let t=j(new Date(e.startDate),new Date(e.endDate))+1;if(1===t)return"1 day";if(t<7)return"".concat(t," days");if(t<14)return"1 week";let a=Math.round(t/7);return"".concat(a," weeks")}(e)]}),(0,r.FD)("p",{children:["Status: ",(0,r.Y)("span",{className:"font-medium ".concat("complete"===e.status?"text-teal-400":"in-progress"===e.status?"text-orange-400":"text-rose-400"),children:function(e){switch(e){case"complete":return"Complete";case"in-progress":return"In Progress";case"not-started":return"Not Started";default:return e}}(e.status)})]}),(0,r.FD)("p",{children:["Progress: ",e.progress,"%"]}),l&&(0,r.FD)("p",{className:"text-red-400 font-medium flex items-center gap-1",children:[(0,r.Y)(L.A,{className:"w-3 h-3"})," Critical Path"]}),e.dependencies&&e.dependencies.length>0&&(0,r.FD)("p",{children:["Dependencies: ",e.dependencies.length]})]})]})})]}),o&&e.progress<=50&&(0,r.FD)("span",{className:"absolute text-[10px] font-semibold text-stone-600 dark:text-stone-300 pointer-events-none",style:{left:a+s+8,top:"50%",transform:"translateY(-50%)"},children:[e.progress,"%"]})]},e.id)}),o&&(0,r.Y)("svg",{className:"absolute top-0 left-0 pointer-events-none z-20",style:{width:F,height:40*k.length},children:k.map(e=>e.dependencies?e.dependencies.map(t=>{let a=k.find(e=>e.id===t);if(!a)return null;let s=k.indexOf(a),n=k.indexOf(e),{left:l,width:o}=R(a,w,D),{left:i}=R(e,w,D),c=l+o+4,m=40*s+20,h=i+4,u=40*n+20,p=(c+h)/2,g=d&&v.has(e.id)&&v.has(t);return(0,r.Y)("path",{d:"M ".concat(c," ").concat(m," C ").concat(p," ").concat(m,", ").concat(p," ").concat(u,", ").concat(h," ").concat(u),fill:"none",stroke:g?"#ef4444":"#78716c",strokeWidth:g?"2":"1.5",strokeDasharray:g?"0":"4"},"dep-".concat(t,"-").concat(e.id))}):null)})]})})]})]})]})})}var V=a(4165),Z=a(5057),H=a(8539),Q=a(7262),W=a(7313),X=a(7655);let ee=n.forwardRef((e,t)=>{let{className:a,children:s,...n}=e;return(0,r.FD)(X.bL,{ref:t,className:(0,I.cn)("relative overflow-hidden",a),...n,children:[(0,r.Y)(X.LM,{className:"h-full w-full rounded-[inherit]",children:s}),(0,r.Y)(et,{}),(0,r.Y)(X.OK,{})]})});ee.displayName=X.bL.displayName;let et=n.forwardRef((e,t)=>{let{className:a,orientation:s="vertical",...n}=e;return(0,r.Y)(X.VM,{ref:t,orientation:s,className:(0,I.cn)("flex touch-none select-none transition-colors","vertical"===s&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...n,children:(0,r.Y)(X.lr,{className:"relative flex-1 rounded-full bg-border"})})});et.displayName=X.VM.displayName;var ea=a(4541),er=a(5731),es=a(1008),en=a(4063),el=a(172),eo=a(1721),ed=a(3672),ei=a(6671);function ec(e){let{open:t,onOpenChange:a,task:s,tasks:o,onSave:d,onDelete:i}=e,{user:c}=(0,ea.A)(),m=!!s,[h,u]=(0,n.useState)(""),[p,g]=(0,n.useState)(""),[f,b]=(0,n.useState)(""),[x,N]=(0,n.useState)("not-started"),[k,v]=(0,n.useState)(0),[w,y]=(0,n.useState)(!1),[D,C]=(0,n.useState)([]),[S,A]=(0,n.useState)(""),[T,j]=(0,n.useState)(""),[R,_]=(0,n.useState)([]),[M,P]=(0,n.useState)(""),[L,E]=(0,n.useState)(!1),[I,z]=(0,n.useState)(!1);function J(e){return e.toISOString().split("T")[0]}async function O(){if(!M.trim()||!s)return;let e=Number(s.id);if(isNaN(e))return void ei.oR.error("Invalid task ID");z(!0);try{let t=await er.Jg.create({task_id:e,user_id:c&&Number(c.id)||void 0,user_name:(null==c?void 0:c.name)||"Anonymous",content:M.trim()});if(t.success&&t.data){let e={id:String(t.data.id),taskId:String(t.data.task_id),userId:t.data.user_id?String(t.data.user_id):"anonymous",userName:t.data.user_name||"Anonymous",content:t.data.content,createdAt:new Date(t.data.created_at)};_([...R,e]),P(""),ei.oR.success("Comment added")}else ei.oR.error("Failed to add comment")}catch(e){ei.oR.error("Failed to add comment")}z(!1)}(0,n.useEffect)(()=>{async function e(){if(s&&t){let e=Number(s.id);if(!isNaN(e)){E(!0);try{let t=await er.Jg.getByTask(e);if(t.success&&t.data){let e=t.data.map(e=>({id:String(e.id),taskId:String(e.task_id),userId:e.user_id?String(e.user_id):"anonymous",userName:e.user_name||"Anonymous",content:e.content,createdAt:new Date(e.created_at)}));_(e)}}catch(e){console.error("Failed to fetch comments:",e)}E(!1)}}}s?(u(s.name),g(J(new Date(s.startDate))),b(J(new Date(s.endDate))),N(s.status),v(s.progress),y(s.isMilestone||!1),C(s.dependencies||[]),A(s.parentId||""),j(s.notes||""),e()):(u(""),g(""),b(""),N("not-started"),v(0),y(!1),C([]),A(""),j(""),_([])),P("")},[s,t]);let $=o.filter(e=>e.id!==(null==s?void 0:s.id)&&e.parentId!==(null==s?void 0:s.id)),U=o.filter(e=>e.id!==(null==s?void 0:s.id)&&!e.parentId);return(0,r.Y)(V.lG,{open:t,onOpenChange:a,children:(0,r.FD)(V.Cf,{className:"sm:max-w-[600px] max-h-[90vh] bg-white dark:bg-stone-800 border-stone-200 dark:border-stone-700",children:[(0,r.FD)(V.c7,{children:[(0,r.Y)(V.L3,{className:"text-stone-800 dark:text-white",children:m?"Edit Task":"Add New Task"}),(0,r.Y)(V.rr,{className:"text-stone-500 dark:text-stone-400",children:m?"Modify the task details below.":"Fill in the details for your new task."})]}),(0,r.FD)(W.tU,{defaultValue:"details",className:"w-full",children:[(0,r.FD)(W.j7,{className:"grid w-full grid-cols-2 dark:bg-stone-700",children:[(0,r.FD)(W.Xi,{value:"details",className:"flex items-center gap-1.5 dark:data-[state=active]:bg-stone-600",children:[(0,r.Y)(es.A,{className:"w-4 h-4"}),"Details"]}),(0,r.FD)(W.Xi,{value:"comments",className:"flex items-center gap-1.5 dark:data-[state=active]:bg-stone-600",children:[(0,r.Y)(en.A,{className:"w-4 h-4"}),"Comments ",R.length>0&&"(".concat(R.length,")")]})]}),(0,r.Y)(W.av,{value:"details",className:"mt-4",children:(0,r.Y)(ee,{className:"h-[400px] pr-4",children:(0,r.FD)("div",{className:"grid gap-4",children:[(0,r.FD)("div",{className:"grid gap-2",children:[(0,r.Y)(Z.J,{htmlFor:"name",className:"text-stone-700 dark:text-stone-200",children:"Task Name"}),(0,r.Y)(Y.p,{id:"name",value:h,onChange:e=>u(e.target.value),placeholder:"Enter task name",className:"border-stone-300 dark:border-stone-600 dark:bg-stone-700 dark:text-white focus:border-orange-500 dark:focus:border-teal-500"})]}),(0,r.FD)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.FD)("div",{className:"grid gap-2",children:[(0,r.Y)(Z.J,{htmlFor:"startDate",className:"text-stone-700 dark:text-stone-200",children:"Start Date"}),(0,r.Y)(Y.p,{id:"startDate",type:"date",value:p,onChange:e=>g(e.target.value),className:"border-stone-300 dark:border-stone-600 dark:bg-stone-700 dark:text-white focus:border-orange-500 dark:focus:border-teal-500"})]}),(0,r.FD)("div",{className:"grid gap-2",children:[(0,r.Y)(Z.J,{htmlFor:"endDate",className:"text-stone-700 dark:text-stone-200",children:"End Date"}),(0,r.Y)(Y.p,{id:"endDate",type:"date",value:f,onChange:e=>b(e.target.value),className:"border-stone-300 dark:border-stone-600 dark:bg-stone-700 dark:text-white focus:border-orange-500 dark:focus:border-teal-500"})]})]}),(0,r.FD)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.FD)("div",{className:"grid gap-2",children:[(0,r.Y)(Z.J,{htmlFor:"status",className:"text-stone-700 dark:text-stone-200",children:"Status"}),(0,r.FD)(F.l6,{value:x,onValueChange:e=>N(e),children:[(0,r.Y)(F.bq,{className:"border-stone-300 dark:border-stone-600 dark:bg-stone-700 dark:text-white",children:(0,r.Y)(F.yv,{})}),(0,r.FD)(F.gC,{className:"dark:bg-stone-800 dark:border-stone-700",children:[(0,r.Y)(F.eb,{value:"not-started",children:"Not Started"}),(0,r.Y)(F.eb,{value:"in-progress",children:"In Progress"}),(0,r.Y)(F.eb,{value:"complete",children:"Complete"})]})]})]}),(0,r.FD)("div",{className:"grid gap-2",children:[(0,r.Y)(Z.J,{htmlFor:"progress",className:"text-stone-700 dark:text-stone-200",children:"Progress (%)"}),(0,r.Y)(Y.p,{id:"progress",type:"number",min:"0",max:"100",value:k,onChange:e=>v(Number(e.target.value)),className:"border-stone-300 dark:border-stone-600 dark:bg-stone-700 dark:text-white focus:border-orange-500 dark:focus:border-teal-500"})]})]}),(0,r.FD)("div",{className:"flex items-center gap-2",children:[(0,r.Y)(Q.S,{id:"milestone",checked:w,onCheckedChange:e=>y(e)}),(0,r.Y)(Z.J,{htmlFor:"milestone",className:"text-stone-700 dark:text-stone-200 cursor-pointer",children:"Mark as Milestone"})]}),(0,r.FD)("div",{className:"grid gap-2",children:[(0,r.Y)(Z.J,{htmlFor:"notes",className:"text-stone-700 dark:text-stone-200",children:"Notes"}),(0,r.Y)(H.T,{id:"notes",value:T,onChange:e=>j(e.target.value),placeholder:"Add any notes or details about this task...",rows:3,className:"border-stone-300 dark:border-stone-600 dark:bg-stone-700 dark:text-white resize-none"})]}),U.length>0&&(0,r.FD)("div",{className:"grid gap-2",children:[(0,r.Y)(Z.J,{htmlFor:"parentTask",className:"text-stone-700 dark:text-stone-200",children:"Parent Task (for subtask)"}),(0,r.FD)(F.l6,{value:S||"none",onValueChange:e=>A("none"===e?"":e),children:[(0,r.Y)(F.bq,{className:"border-stone-300 dark:border-stone-600 dark:bg-stone-700 dark:text-white",children:(0,r.Y)(F.yv,{placeholder:"None (top-level task)"})}),(0,r.FD)(F.gC,{className:"dark:bg-stone-800 dark:border-stone-700",children:[(0,r.Y)(F.eb,{value:"none",children:"None (top-level task)"}),U.map(e=>(0,r.Y)(F.eb,{value:e.id,children:e.name},e.id))]})]})]}),$.length>0&&(0,r.FD)("div",{className:"grid gap-2",children:[(0,r.Y)(Z.J,{className:"text-stone-700 dark:text-stone-200",children:"Dependencies"}),(0,r.Y)("div",{className:"max-h-32 overflow-y-auto border rounded-md p-2 border-stone-200 dark:border-stone-600 bg-white dark:bg-stone-700",children:$.map(e=>(0,r.FD)("div",{className:"flex items-center gap-2 py-1",children:[(0,r.Y)(Q.S,{id:"dep-".concat(e.id),checked:D.includes(e.id),onCheckedChange:t=>{t?C([...D,e.id]):C(D.filter(t=>t!==e.id))}}),(0,r.Y)(Z.J,{htmlFor:"dep-".concat(e.id),className:"text-sm text-stone-600 dark:text-stone-300 cursor-pointer",children:e.name})]},e.id))})]})]})})}),(0,r.Y)(W.av,{value:"comments",className:"mt-4",children:(0,r.FD)("div",{className:"h-[400px] flex flex-col",children:[(0,r.Y)(ee,{className:"flex-1 pr-4 mb-4",children:L?(0,r.FD)("div",{className:"flex flex-col items-center justify-center h-full text-stone-400 dark:text-stone-500 py-8",children:[(0,r.Y)(el.A,{className:"w-8 h-8 mb-2 animate-spin text-teal-600"}),(0,r.Y)("p",{className:"text-sm",children:"Loading comments..."})]}):0===R.length?(0,r.FD)("div",{className:"flex flex-col items-center justify-center h-full text-stone-400 dark:text-stone-500 py-8",children:[(0,r.Y)(en.A,{className:"w-12 h-12 mb-2 opacity-50"}),(0,r.Y)("p",{className:"text-sm",children:"No comments yet"}),(0,r.Y)("p",{className:"text-xs",children:"Be the first to add a comment"})]}):(0,r.Y)("div",{className:"space-y-3",children:R.map(e=>(0,r.FD)("div",{className:"p-3 bg-stone-50 dark:bg-stone-700 rounded-lg",children:[(0,r.FD)("div",{className:"flex items-center gap-2 mb-1",children:[(0,r.Y)("div",{className:"w-6 h-6 rounded-full bg-teal-100 dark:bg-teal-900 flex items-center justify-center",children:(0,r.Y)(eo.A,{className:"w-3.5 h-3.5 text-teal-600 dark:text-teal-400"})}),(0,r.Y)("span",{className:"text-sm font-medium text-stone-700 dark:text-stone-200",children:e.userName}),(0,r.Y)("span",{className:"text-xs text-stone-400 dark:text-stone-500",children:new Date(e.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),(0,r.Y)("p",{className:"text-sm text-stone-600 dark:text-stone-300 pl-8",children:e.content})]},e.id))})}),(0,r.FD)("div",{className:"flex gap-2 pt-2 border-t border-stone-200 dark:border-stone-600",children:[(0,r.Y)(Y.p,{value:M,onChange:e=>P(e.target.value),placeholder:m?"Add a comment...":"Save task first to add comments",disabled:!m||I,className:"flex-1 border-stone-300 dark:border-stone-600 dark:bg-stone-700 dark:text-white",onKeyDown:e=>{"Enter"===e.key&&!e.shiftKey&&m&&(e.preventDefault(),O())}}),(0,r.Y)(l.$,{type:"button",size:"icon",onClick:O,disabled:!M.trim()||!m||I,className:"bg-teal-600 hover:bg-teal-700 text-white",children:I?(0,r.Y)(el.A,{className:"w-4 h-4 animate-spin"}):(0,r.Y)(ed.A,{className:"w-4 h-4"})})]})]})})]}),(0,r.FD)(V.Es,{className:"flex gap-2 mt-4",children:[m&&i&&(0,r.Y)(l.$,{type:"button",variant:"destructive",onClick:function(){s&&i&&(i(s.id),a(!1))},className:"mr-auto",children:"Delete"}),(0,r.Y)(l.$,{type:"button",variant:"outline",onClick:()=>a(!1),className:"border-stone-300 dark:border-stone-600 text-stone-700 dark:text-stone-200 dark:hover:bg-stone-700",children:"Cancel"}),(0,r.Y)(l.$,{type:"button",onClick:function(){h&&p&&f&&(d({id:(null==s?void 0:s.id)||Math.random().toString(36).substring(2,9),name:h,startDate:new Date(p),endDate:new Date(f),status:x,progress:k,isMilestone:w,dependencies:D.length>0?D:void 0,parentId:S||void 0,order:(null==s?void 0:s.order)||o.length+1,notes:T||void 0,comments:R.length>0?R:void 0}),a(!1))},className:"bg-stone-800 dark:bg-teal-600 hover:bg-stone-900 dark:hover:bg-teal-700 text-white",children:m?"Save Changes":"Add Task"})]})]})})}var em=a(4050);let eh=n.forwardRef((e,t)=>{let{className:a,orientation:s="horizontal",decorative:n=!0,...l}=e;return(0,r.Y)(em.b,{ref:t,decorative:n,orientation:s,className:(0,I.cn)("shrink-0 bg-border","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",a),...l})});eh.displayName=em.b.displayName;let eu={logoLight:"/images/logo/ocf-logo.png",logoDark:"/images/logo/OCFLogoSTrans.png",logoFallbackText:"OCF",companyName:"Oasis Capital Finance",defaultProjectName:"OCF Bond Issuance Project",defaultProjectDescription:"Project Timeline & Task Management"},ep="gantt-app-settings";function eg(){try{let e=localStorage.getItem(ep);if(e){let t=JSON.parse(e);return{...eu,...t}}}catch(e){console.error("Failed to load settings:",e)}return eu}var ef=a(3173),eb=a(8531);function ex(e){let{open:t,onOpenChange:a,onSettingsChange:s}=e,[o,i]=(0,n.useState)({...eu}),[m,u]=(0,n.useState)(""),[g,f]=(0,n.useState)(""),[b,x]=(0,n.useState)(!1),[N,k]=(0,n.useState)(!1);(0,n.useEffect)(()=>{if(t){let e=eg();i(e),u(e.logoLight),f(e.logoDark),x(!1),k(!1)}},[t]);let v=(e,t)=>{var a;let r=null==(a=e.target.files)?void 0:a[0];if(!r)return;let s=new FileReader;s.onload=e=>{var a;let r=null==(a=e.target)?void 0:a.result;"light"===t?(u(r),x(!1),i(e=>({...e,logoLight:r}))):(f(r),k(!1),i(e=>({...e,logoDark:r})))},s.readAsDataURL(r)};return(0,r.Y)(V.lG,{open:t,onOpenChange:a,children:(0,r.FD)(V.Cf,{className:"sm:max-w-[550px] dark:bg-stone-900 dark:border-stone-700",children:[(0,r.FD)(V.c7,{children:[(0,r.FD)(V.L3,{className:"flex items-center gap-2 dark:text-white",children:[(0,r.Y)(ef.A,{className:"w-5 h-5"}),"App Settings"]}),(0,r.Y)(V.rr,{className:"dark:text-stone-400",children:"Customize the branding and appearance of your Gantt chart application."})]}),(0,r.FD)("div",{className:"space-y-6 py-4",children:[(0,r.FD)("div",{className:"space-y-4",children:[(0,r.FD)("h3",{className:"text-sm font-semibold text-stone-700 dark:text-stone-300 flex items-center gap-2",children:[(0,r.Y)(c.A,{className:"w-4 h-4"}),"Logo Settings"]}),(0,r.FD)("div",{className:"space-y-2",children:[(0,r.FD)(Z.J,{className:"flex items-center gap-2 text-stone-600 dark:text-stone-400",children:[(0,r.Y)(p.A,{className:"w-3.5 h-3.5"}),"Light Mode Logo"]}),(0,r.FD)("div",{className:"flex gap-3",children:[(0,r.Y)("div",{className:"flex-1",children:(0,r.Y)(Y.p,{value:m,onChange:e=>{u(e.target.value),x(!1)},placeholder:"Enter logo URL or upload file...",className:"dark:bg-stone-800 dark:border-stone-700 dark:text-white"})}),(0,r.FD)("label",{className:"cursor-pointer",children:[(0,r.Y)("input",{type:"file",accept:"image/*",className:"hidden",onChange:e=>v(e,"light")}),(0,r.Y)(l.$,{type:"button",variant:"outline",size:"icon",asChild:!0,children:(0,r.Y)("span",{children:(0,r.Y)(d.A,{className:"w-4 h-4"})})})]})]}),(0,r.Y)("div",{className:"h-12 bg-white border border-stone-200 rounded-lg flex items-center justify-center p-2",children:!b&&m?(0,r.Y)("img",{src:m,alt:"Light logo preview",className:"max-h-8 max-w-full object-contain",onError:()=>x(!0)}):(0,r.FD)("div",{className:"flex items-center gap-2 text-stone-400 text-sm",children:[(0,r.Y)("div",{className:"w-8 h-8 rounded bg-teal-600 flex items-center justify-center",children:(0,r.Y)("span",{className:"text-white font-bold text-xs",children:o.logoFallbackText})}),(0,r.Y)("span",{children:"Fallback logo"})]})})]}),(0,r.FD)("div",{className:"space-y-2",children:[(0,r.FD)(Z.J,{className:"flex items-center gap-2 text-stone-600 dark:text-stone-400",children:[(0,r.Y)(h.A,{className:"w-3.5 h-3.5"}),"Dark Mode Logo"]}),(0,r.FD)("div",{className:"flex gap-3",children:[(0,r.Y)("div",{className:"flex-1",children:(0,r.Y)(Y.p,{value:g,onChange:e=>{f(e.target.value),k(!1)},placeholder:"Enter logo URL or upload file...",className:"dark:bg-stone-800 dark:border-stone-700 dark:text-white"})}),(0,r.FD)("label",{className:"cursor-pointer",children:[(0,r.Y)("input",{type:"file",accept:"image/*",className:"hidden",onChange:e=>v(e,"dark")}),(0,r.Y)(l.$,{type:"button",variant:"outline",size:"icon",asChild:!0,children:(0,r.Y)("span",{children:(0,r.Y)(d.A,{className:"w-4 h-4"})})})]})]}),(0,r.Y)("div",{className:"h-12 bg-stone-800 border border-stone-700 rounded-lg flex items-center justify-center p-2",children:!N&&g?(0,r.Y)("img",{src:g,alt:"Dark logo preview",className:"max-h-8 max-w-full object-contain",onError:()=>k(!0)}):(0,r.FD)("div",{className:"flex items-center gap-2 text-stone-500 text-sm",children:[(0,r.Y)("div",{className:"w-8 h-8 rounded bg-teal-500 flex items-center justify-center",children:(0,r.Y)("span",{className:"text-white font-bold text-xs",children:o.logoFallbackText})}),(0,r.Y)("span",{children:"Fallback logo"})]})})]}),(0,r.FD)("div",{className:"space-y-2",children:[(0,r.Y)(Z.J,{className:"text-stone-600 dark:text-stone-400",children:"Fallback Logo Text"}),(0,r.Y)(Y.p,{value:o.logoFallbackText,onChange:e=>i(t=>({...t,logoFallbackText:e.target.value.slice(0,5)})),placeholder:"OCF",maxLength:5,className:"dark:bg-stone-800 dark:border-stone-700 dark:text-white"}),(0,r.Y)("p",{className:"text-xs text-stone-500 dark:text-stone-500",children:"Shown when logo fails to load (max 5 characters)"})]})]}),(0,r.Y)(eh,{className:"dark:bg-stone-700"}),(0,r.FD)("div",{className:"space-y-4",children:[(0,r.FD)("h3",{className:"text-sm font-semibold text-stone-700 dark:text-stone-300 flex items-center gap-2",children:[(0,r.Y)(ef.A,{className:"w-4 h-4"}),"Branding"]}),(0,r.FD)("div",{className:"space-y-2",children:[(0,r.Y)(Z.J,{className:"text-stone-600 dark:text-stone-400",children:"Company Name"}),(0,r.Y)(Y.p,{value:o.companyName,onChange:e=>i(t=>({...t,companyName:e.target.value})),placeholder:"Oasis Capital Finance",className:"dark:bg-stone-800 dark:border-stone-700 dark:text-white"})]}),(0,r.FD)("div",{className:"space-y-2",children:[(0,r.Y)(Z.J,{className:"text-stone-600 dark:text-stone-400",children:"Default Project Name"}),(0,r.Y)(Y.p,{value:o.defaultProjectName,onChange:e=>i(t=>({...t,defaultProjectName:e.target.value})),placeholder:"Project Name",className:"dark:bg-stone-800 dark:border-stone-700 dark:text-white"})]}),(0,r.FD)("div",{className:"space-y-2",children:[(0,r.Y)(Z.J,{className:"text-stone-600 dark:text-stone-400",children:"Default Project Description"}),(0,r.Y)(Y.p,{value:o.defaultProjectDescription,onChange:e=>i(t=>({...t,defaultProjectDescription:e.target.value})),placeholder:"Project Timeline & Task Management",className:"dark:bg-stone-800 dark:border-stone-700 dark:text-white"})]})]})]}),(0,r.FD)(V.Es,{className:"gap-2 sm:gap-0",children:[(0,r.FD)(l.$,{type:"button",variant:"outline",onClick:()=>{let e=function(){try{localStorage.removeItem(ep)}catch(e){console.error("Failed to reset settings:",e)}return eu}();i(e),u(e.logoLight),f(e.logoDark),x(!1),k(!1),null==s||s(e)},className:"dark:border-stone-600 dark:text-stone-300 dark:hover:bg-stone-800",children:[(0,r.Y)(eb.A,{className:"w-4 h-4 mr-2"}),"Reset to Defaults"]}),(0,r.Y)(l.$,{type:"button",variant:"outline",onClick:()=>a(!1),className:"dark:border-stone-600 dark:text-stone-300 dark:hover:bg-stone-800",children:"Cancel"}),(0,r.Y)(l.$,{type:"button",onClick:()=>{let e=function(e){let t={...eg(),...e};try{localStorage.setItem(ep,JSON.stringify(t))}catch(e){console.error("Failed to save settings:",e)}return t}({...o,logoLight:m||o.logoLight,logoDark:g||o.logoDark});null==s||s(e),a(!1)},className:"bg-teal-600 hover:bg-teal-700 text-white",children:"Save Settings"})]})]})})}var eN=a(6126),ek=a(5300),ev=a(5943),ew=a(7223),ey=a(7300),eD=a(1920),eY=a(9119);let eF=[{value:"bond_issuance",label:"Bond Issuance"},{value:"equity_raise",label:"Equity Raise"},{value:"merger_acquisition",label:"Merger & Acquisition"},{value:"ipo",label:"IPO"},{value:"private_placement",label:"Private Placement"},{value:"restructuring",label:"Restructuring"},{value:"other",label:"Other"}],eC=[{value:"#14b8a6",label:"Teal"},{value:"#f97316",label:"Orange"},{value:"#8b5cf6",label:"Purple"},{value:"#3b82f6",label:"Blue"},{value:"#22c55e",label:"Green"},{value:"#ef4444",label:"Red"},{value:"#eab308",label:"Yellow"},{value:"#ec4899",label:"Pink"}];function eS(e){var t,a;let{open:s,onOpenChange:o,onTemplatesChanged:d}=e,[i,c]=(0,n.useState)([]),[m,h]=(0,n.useState)(null),[u,p]=(0,n.useState)(!1),[g,b]=(0,n.useState)(!1),[x,N]=(0,n.useState)(!1),[k,w]=(0,n.useState)(null),[y,D]=(0,n.useState)({name:"",description:"",projectType:"bond_issuance",color:"#14b8a6"}),[C,S]=(0,n.useState)(!1),[A,T]=(0,n.useState)(null),[j,R]=(0,n.useState)({name:"",description:"",daysFromStart:0,durationDays:1,priority:"medium",isMilestone:!1}),_=(0,n.useCallback)(async()=>{p(!0);try{let e=await er.E3.getAll();e.success&&e.data&&c(e.data)}catch(e){ei.oR.error("Failed to load templates")}p(!1)},[]),M=(0,n.useCallback)(async e=>{try{let t=await er.E3.get(e);t.success&&t.data&&h(t.data)}catch(e){ei.oR.error("Failed to load template details")}},[]);(0,n.useEffect)(()=>{s&&_()},[s,_]);let P=e=>{w(e),D({name:e.name,description:e.description,projectType:e.project_type,color:e.color}),N(!0)},L=async()=>{if(!y.name.trim())return void ei.oR.error("Template name is required");b(!0);try{if(k)(await er.E3.update(k.id,{name:y.name,description:y.description,project_type:y.projectType,color:y.color})).success&&(ei.oR.success("Template updated"),_(),(null==m?void 0:m.id)===k.id&&M(k.id));else{let e=await er.E3.create({name:y.name,description:y.description,project_type:y.projectType,color:y.color});e.success&&e.data&&(ei.oR.success("Template created"),_(),h(e.data))}N(!1),null==d||d()}catch(e){ei.oR.error("Failed to save template")}b(!1)},E=async e=>{if(confirm("Are you sure you want to delete this template?"))try{(await er.E3.delete(e)).success&&(ei.oR.success("Template deleted"),_(),(null==m?void 0:m.id)===e&&h(null),null==d||d())}catch(e){ei.oR.error("Failed to delete template")}},I=e=>{T(e),R({name:e.name,description:e.description,daysFromStart:e.days_from_start,durationDays:e.duration_days,priority:e.priority,isMilestone:e.is_milestone}),S(!0)},z=async()=>{if(!j.name.trim())return void ei.oR.error("Task name is required");if(m){b(!0);try{if(A){let e=await er.E3.updateTask(A.id,{name:j.name,description:j.description,days_from_start:j.daysFromStart,duration_days:j.durationDays,priority:j.priority,is_milestone:j.isMilestone});e.success&&e.data&&(ei.oR.success("Task updated"),h(e.data))}else{let e=await er.E3.addTask(m.id,{name:j.name,description:j.description,days_from_start:j.daysFromStart,duration_days:j.durationDays,priority:j.priority,is_milestone:j.isMilestone});e.success&&e.data&&(ei.oR.success("Task added"),h(e.data))}S(!1),_()}catch(e){ei.oR.error("Failed to save task")}b(!1)}},J=async e=>{if(confirm("Are you sure you want to delete this task?"))try{let t=await er.E3.deleteTask(e);t.success&&t.data&&(ei.oR.success("Task deleted"),h(t.data),_())}catch(e){ei.oR.error("Failed to delete task")}};return(0,r.Y)(V.lG,{open:s,onOpenChange:o,children:(0,r.FD)(V.Cf,{className:"sm:max-w-[900px] h-[80vh] dark:bg-stone-900 dark:border-stone-700 flex flex-col",children:[(0,r.FD)(V.c7,{children:[(0,r.FD)(V.L3,{className:"dark:text-white flex items-center gap-2",children:[(0,r.Y)(ek.A,{className:"w-5 h-5"}),"Template Manager"]}),(0,r.Y)(V.rr,{className:"dark:text-stone-400",children:"Create and manage project templates with predefined tasks."})]}),(0,r.FD)("div",{className:"flex-1 flex gap-4 overflow-hidden",children:[(0,r.FD)("div",{className:"w-1/3 border-r border-stone-200 dark:border-stone-700 pr-4",children:[(0,r.FD)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.Y)("h3",{className:"text-sm font-medium dark:text-white",children:"Templates"}),(0,r.FD)(l.$,{size:"sm",onClick:()=>{w(null),D({name:"",description:"",projectType:"bond_issuance",color:"#14b8a6"}),N(!0)},className:"h-7 px-2 bg-teal-600 hover:bg-teal-700 text-white",children:[(0,r.Y)(f.A,{className:"w-3.5 h-3.5 mr-1"}),"New"]})]}),u?(0,r.Y)("div",{className:"flex items-center justify-center h-40",children:(0,r.Y)(el.A,{className:"w-6 h-6 animate-spin text-teal-600"})}):(0,r.Y)(ee,{className:"h-[calc(100%-40px)]",children:(0,r.FD)("div",{className:"space-y-2 pr-2",children:[i.map(e=>(0,r.FD)("div",{className:"p-3 rounded-lg border cursor-pointer transition-colors ".concat((null==m?void 0:m.id)===e.id?"border-teal-500 bg-teal-50 dark:bg-teal-900/20":"border-stone-200 dark:border-stone-700 hover:bg-stone-50 dark:hover:bg-stone-800"),onClick:()=>M(e.id),children:[(0,r.FD)("div",{className:"flex items-center gap-2",children:[(0,r.Y)("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:e.color}}),(0,r.Y)("span",{className:"font-medium dark:text-white truncate",children:e.name})]}),(0,r.FD)("div",{className:"flex items-center gap-2 mt-1 text-xs text-stone-500",children:[(0,r.Y)(eN.E,{variant:"outline",className:"text-[10px] px-1.5 py-0",children:e.project_type.replace("_"," ")}),(0,r.FD)("span",{children:[e.task_count," tasks"]})]})]},e.id)),0===i.length&&(0,r.Y)("p",{className:"text-sm text-stone-500 dark:text-stone-400 text-center py-8",children:"No templates yet. Create your first one!"})]})})]}),(0,r.Y)("div",{className:"flex-1 overflow-hidden",children:m?(0,r.FD)("div",{className:"h-full flex flex-col",children:[(0,r.FD)("div",{className:"flex items-start justify-between mb-4",children:[(0,r.FD)("div",{children:[(0,r.FD)("div",{className:"flex items-center gap-2",children:[(0,r.Y)("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:m.color}}),(0,r.Y)("h3",{className:"text-lg font-semibold dark:text-white",children:m.name})]}),m.description&&(0,r.Y)("p",{className:"text-sm text-stone-500 dark:text-stone-400 mt-1",children:m.description}),(0,r.FD)("div",{className:"flex items-center gap-3 mt-2 text-xs text-stone-500",children:[(0,r.Y)(eN.E,{variant:"secondary",children:m.project_type.replace("_"," ")}),(0,r.FD)("span",{children:[(null==(t=m.tasks)?void 0:t.length)||0," tasks"]}),(0,r.FD)("span",{children:["~",m.total_duration_days," days"]})]})]}),(0,r.FD)("div",{className:"flex items-center gap-1",children:[(0,r.Y)(l.$,{variant:"ghost",size:"sm",onClick:()=>P(m),className:"h-8 px-2",children:(0,r.Y)(ev.A,{className:"w-4 h-4"})}),(0,r.Y)(l.$,{variant:"ghost",size:"sm",onClick:()=>E(m.id),className:"h-8 px-2 text-red-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20",children:(0,r.Y)(ew.A,{className:"w-4 h-4"})})]})]}),(0,r.FD)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.Y)("h4",{className:"text-sm font-medium dark:text-white",children:"Template Tasks"}),(0,r.FD)(l.$,{size:"sm",onClick:()=>{var e;T(null),R({name:"",description:"",daysFromStart:(null==m||null==(e=m.tasks)?void 0:e.length)?Math.max(...m.tasks.map(e=>e.days_from_start+e.duration_days)):0,durationDays:1,priority:"medium",isMilestone:!1}),S(!0)},className:"h-7 px-2 bg-teal-600 hover:bg-teal-700 text-white",children:[(0,r.Y)(f.A,{className:"w-3.5 h-3.5 mr-1"}),"Add Task"]})]}),(0,r.Y)(ee,{className:"flex-1",children:(0,r.FD)("div",{className:"space-y-2 pr-2",children:[null==(a=m.tasks)?void 0:a.map((e,t)=>(0,r.Y)("div",{className:"p-3 bg-stone-50 dark:bg-stone-800 rounded-lg border border-stone-200 dark:border-stone-700",children:(0,r.FD)("div",{className:"flex items-start justify-between",children:[(0,r.FD)("div",{className:"flex items-start gap-2",children:[(0,r.FD)("span",{className:"text-xs text-stone-400 w-5 flex-shrink-0 mt-0.5",children:[t+1,"."]}),(0,r.FD)("div",{children:[(0,r.FD)("div",{className:"flex items-center gap-1.5",children:[(0,r.Y)("span",{className:"font-medium dark:text-white",children:e.name}),e.is_milestone&&(0,r.Y)(ey.A,{className:"w-3.5 h-3.5 text-orange-500"})]}),(0,r.FD)("div",{className:"flex items-center gap-3 mt-1 text-xs text-stone-500",children:[(0,r.FD)("span",{className:"flex items-center gap-1",children:[(0,r.Y)(eD.A,{className:"w-3 h-3"}),"Day ",e.days_from_start+1]}),(0,r.FD)("span",{className:"flex items-center gap-1",children:[(0,r.Y)(v.A,{className:"w-3 h-3"}),e.duration_days,"d"]}),(0,r.Y)(eN.E,{variant:"outline",className:"text-[10px] px-1.5 py-0 ".concat("critical"===e.priority?"border-red-500 text-red-500":"high"===e.priority?"border-orange-500 text-orange-500":"low"===e.priority?"border-stone-400 text-stone-400":"border-stone-300 text-stone-500"),children:e.priority})]})]})]}),(0,r.FD)("div",{className:"flex items-center gap-1",children:[(0,r.Y)(l.$,{variant:"ghost",size:"sm",onClick:()=>I(e),className:"h-6 w-6 p-0",children:(0,r.Y)(ev.A,{className:"w-3 h-3"})}),(0,r.Y)(l.$,{variant:"ghost",size:"sm",onClick:()=>J(e.id),className:"h-6 w-6 p-0 text-red-500 hover:text-red-600",children:(0,r.Y)(ew.A,{className:"w-3 h-3"})})]})]})},e.id)),(!m.tasks||0===m.tasks.length)&&(0,r.Y)("p",{className:"text-sm text-stone-500 dark:text-stone-400 text-center py-8",children:"No tasks yet. Add tasks to this template."})]})})]}):(0,r.Y)("div",{className:"h-full flex items-center justify-center text-stone-500 dark:text-stone-400",children:(0,r.FD)("div",{className:"text-center",children:[(0,r.Y)(ek.A,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,r.Y)("p",{children:"Select a template to view details"}),(0,r.Y)("p",{className:"text-sm",children:"or create a new one"})]})})})]}),(0,r.Y)(V.lG,{open:x,onOpenChange:N,children:(0,r.FD)(V.Cf,{className:"sm:max-w-[450px] dark:bg-stone-800 dark:border-stone-700",children:[(0,r.Y)(V.c7,{children:(0,r.Y)(V.L3,{className:"dark:text-white",children:k?"Edit Template":"Create Template"})}),(0,r.FD)("div",{className:"grid gap-4 py-4",children:[(0,r.FD)("div",{className:"grid gap-2",children:[(0,r.Y)(Z.J,{htmlFor:"templateName",className:"dark:text-stone-200",children:"Template Name"}),(0,r.Y)(Y.p,{id:"templateName",value:y.name,onChange:e=>D({...y,name:e.target.value}),placeholder:"e.g., Bond Issuance",className:"dark:bg-stone-700 dark:border-stone-600"})]}),(0,r.FD)("div",{className:"grid gap-2",children:[(0,r.Y)(Z.J,{htmlFor:"templateDesc",className:"dark:text-stone-200",children:"Description"}),(0,r.Y)(H.T,{id:"templateDesc",value:y.description,onChange:e=>D({...y,description:e.target.value}),placeholder:"Brief description of this template",rows:2,className:"dark:bg-stone-700 dark:border-stone-600 resize-none"})]}),(0,r.FD)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.FD)("div",{className:"grid gap-2",children:[(0,r.Y)(Z.J,{className:"dark:text-stone-200",children:"Project Type"}),(0,r.FD)(F.l6,{value:y.projectType,onValueChange:e=>D({...y,projectType:e}),children:[(0,r.Y)(F.bq,{className:"dark:bg-stone-700 dark:border-stone-600",children:(0,r.Y)(F.yv,{})}),(0,r.Y)(F.gC,{className:"dark:bg-stone-700 dark:border-stone-600",children:eF.map(e=>(0,r.Y)(F.eb,{value:e.value,children:e.label},e.value))})]})]}),(0,r.FD)("div",{className:"grid gap-2",children:[(0,r.Y)(Z.J,{className:"dark:text-stone-200",children:"Color"}),(0,r.FD)(F.l6,{value:y.color,onValueChange:e=>D({...y,color:e}),children:[(0,r.Y)(F.bq,{className:"dark:bg-stone-700 dark:border-stone-600",children:(0,r.FD)("div",{className:"flex items-center gap-2",children:[(0,r.Y)("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:y.color}}),(0,r.Y)(F.yv,{})]})}),(0,r.Y)(F.gC,{className:"dark:bg-stone-700 dark:border-stone-600",children:eC.map(e=>(0,r.Y)(F.eb,{value:e.value,children:(0,r.FD)("div",{className:"flex items-center gap-2",children:[(0,r.Y)("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:e.value}}),e.label]})},e.value))})]})]})]})]}),(0,r.FD)(V.Es,{children:[(0,r.Y)(l.$,{variant:"outline",onClick:()=>N(!1),children:"Cancel"}),(0,r.FD)(l.$,{onClick:L,disabled:g,className:"bg-teal-600 hover:bg-teal-700 text-white",children:[g?(0,r.Y)(el.A,{className:"w-4 h-4 animate-spin"}):(0,r.Y)(eY.A,{className:"w-4 h-4 mr-1"}),k?"Update":"Create"]})]})]})}),(0,r.Y)(V.lG,{open:C,onOpenChange:S,children:(0,r.FD)(V.Cf,{className:"sm:max-w-[450px] dark:bg-stone-800 dark:border-stone-700",children:[(0,r.Y)(V.c7,{children:(0,r.Y)(V.L3,{className:"dark:text-white",children:A?"Edit Task":"Add Task"})}),(0,r.FD)("div",{className:"grid gap-4 py-4",children:[(0,r.FD)("div",{className:"grid gap-2",children:[(0,r.Y)(Z.J,{htmlFor:"taskName",className:"dark:text-stone-200",children:"Task Name"}),(0,r.Y)(Y.p,{id:"taskName",value:j.name,onChange:e=>R({...j,name:e.target.value}),placeholder:"e.g., Due Diligence Review",className:"dark:bg-stone-700 dark:border-stone-600"})]}),(0,r.FD)("div",{className:"grid gap-2",children:[(0,r.FD)(Z.J,{htmlFor:"taskDesc",className:"dark:text-stone-200",children:["Description ",(0,r.Y)("span",{className:"text-stone-400 text-xs",children:"(optional)"})]}),(0,r.Y)(H.T,{id:"taskDesc",value:j.description,onChange:e=>R({...j,description:e.target.value}),rows:2,className:"dark:bg-stone-700 dark:border-stone-600 resize-none"})]}),(0,r.FD)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.FD)("div",{className:"grid gap-2",children:[(0,r.Y)(Z.J,{className:"dark:text-stone-200",children:"Days from Start"}),(0,r.Y)(Y.p,{type:"number",min:"0",value:j.daysFromStart,onChange:e=>R({...j,daysFromStart:Number(e.target.value)}),className:"dark:bg-stone-700 dark:border-stone-600"}),(0,r.FD)("p",{className:"text-xs text-stone-400",children:["Task starts on day ",j.daysFromStart+1]})]}),(0,r.FD)("div",{className:"grid gap-2",children:[(0,r.Y)(Z.J,{className:"dark:text-stone-200",children:"Duration (days)"}),(0,r.Y)(Y.p,{type:"number",min:"1",value:j.durationDays,onChange:e=>R({...j,durationDays:Math.max(1,Number(e.target.value))}),className:"dark:bg-stone-700 dark:border-stone-600"})]})]}),(0,r.FD)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.FD)("div",{className:"grid gap-2",children:[(0,r.Y)(Z.J,{className:"dark:text-stone-200",children:"Priority"}),(0,r.FD)(F.l6,{value:j.priority,onValueChange:e=>R({...j,priority:e}),children:[(0,r.Y)(F.bq,{className:"dark:bg-stone-700 dark:border-stone-600",children:(0,r.Y)(F.yv,{})}),(0,r.FD)(F.gC,{className:"dark:bg-stone-700 dark:border-stone-600",children:[(0,r.Y)(F.eb,{value:"low",children:"Low"}),(0,r.Y)(F.eb,{value:"medium",children:"Medium"}),(0,r.Y)(F.eb,{value:"high",children:"High"}),(0,r.Y)(F.eb,{value:"critical",children:"Critical"})]})]})]}),(0,r.FD)("div",{className:"grid gap-2",children:[(0,r.Y)(Z.J,{className:"dark:text-stone-200",children:"Milestone"}),(0,r.FD)("div",{className:"flex items-center gap-2 h-10",children:[(0,r.Y)(Q.S,{id:"isMilestone",checked:j.isMilestone,onCheckedChange:e=>R({...j,isMilestone:e})}),(0,r.Y)(Z.J,{htmlFor:"isMilestone",className:"text-sm dark:text-stone-300 cursor-pointer",children:"Mark as milestone"})]})]})]})]}),(0,r.FD)(V.Es,{children:[(0,r.Y)(l.$,{variant:"outline",onClick:()=>S(!1),children:"Cancel"}),(0,r.FD)(l.$,{onClick:z,disabled:g,className:"bg-teal-600 hover:bg-teal-700 text-white",children:[g?(0,r.Y)(el.A,{className:"w-4 h-4 animate-spin"}):(0,r.Y)(eY.A,{className:"w-4 h-4 mr-1"}),A?"Update":"Add"]})]})]})})]})})}var eA=a(1794),eT=a(286),ej=a(518),eR=a(3896),e_=a(7607),eM=a(4260);function eP(e){let{onProjectChange:t}=e,{user:a,projects:s,currentProject:d,setCurrentProject:i,createProject:c,allocateProjectToClient:m,getAllClients:h,templates:u,loadTemplates:p,getTemplateWithTasks:g}=(0,ea.A)(),[b,x]=(0,n.useState)(!1),[N,k]=(0,n.useState)(!1),[w,y]=(0,n.useState)(""),[D,C]=(0,n.useState)(""),[S,A]=(0,n.useState)(""),[T,j]=(0,n.useState)(""),[R,_]=(0,n.useState)(""),[M,L]=(0,n.useState)(""),[E,I]=(0,n.useState)(!1),[z,J]=(0,n.useState)(!1),[O,$]=(0,n.useState)(!1),[U,B]=(0,n.useState)([]),[q,K]=(0,n.useState)(!1),G=a&&(0,eM.UE)(a.role),H=a&&(0,eM.vn)(a.role),Q=h();(0,n.useEffect)(()=>{b&&0===u.length&&p()},[b,u.length,p]),(0,n.useEffect)(()=>{b&&!R&&_(new Date().toISOString().split("T")[0])},[b,R]);let W=(0,n.useCallback)(async e=>{if(!e)return;K(!0);let t=await g(Number(e));(null==t?void 0:t.tasks)&&B(t.tasks),K(!1)},[g]);(0,n.useEffect)(()=>{T&&O&&W(T)},[T,O,W]);let X=u.find(e=>String(e.id)===T),et=e=>{i(e),null==t||t(e)},er=async()=>{if(w.trim()){if(T&&!R)return void ei.oR.error("Please select a start date for the project");I(!0);try{let e=T?Number(T):void 0,a=T?R:void 0,r=await c(w,D,e,a,M||void 0);if(r){null==t||t(r);let e=null==X?void 0:X.name;e?ei.oR.success('Project created from "'.concat(e,'" template')):ei.oR.success("Project created"),es()}else ei.oR.error("Failed to create project")}catch(e){ei.oR.error("Failed to create project")}I(!1)}},es=()=>{x(!1),y(""),C(""),j(""),_(""),L(""),$(!1),B([])},en=async()=>{if(d&&S){J(!0);try{await m(d.id,S),ei.oR.success("Project allocated to client"),k(!1),A("")}catch(e){ei.oR.error("Failed to allocate project")}J(!1)}},eo=async()=>{!O&&T&&0===U.length&&await W(T),$(!O)},ed=e=>{if(!R)return"Day ".concat(e+1);let t=new Date(R);return t.setDate(t.getDate()+e),t.toLocaleDateString("en-US",{month:"short",day:"numeric"})};return d?(0,r.FD)(r.FK,{children:[(0,r.FD)(o.rI,{children:[(0,r.Y)(o.ty,{asChild:!0,children:(0,r.FD)(l.$,{variant:"outline",size:"sm",className:"border-stone-300 dark:border-stone-600 text-stone-700 dark:text-stone-200 hover:bg-stone-100 dark:hover:bg-stone-800 gap-2 max-w-[200px]",children:[(0,r.Y)(eA.A,{className:"w-4 h-4 flex-shrink-0"}),(0,r.Y)("span",{className:"truncate hidden sm:inline",children:d.name}),(0,r.Y)(P.A,{className:"w-3.5 h-3.5 opacity-50 flex-shrink-0"})]})}),(0,r.FD)(o.SQ,{align:"start",className:"w-64 dark:bg-stone-800 dark:border-stone-700",children:[(0,r.Y)(o.lp,{className:"text-xs text-stone-500 dark:text-stone-400",children:"Projects"}),s.map(e=>(0,r.FD)(o._2,{onClick:()=>et(e),className:"dark:hover:bg-stone-700 cursor-pointer flex items-center justify-between",children:[(0,r.FD)("div",{className:"flex-1 min-w-0",children:[(0,r.Y)("p",{className:"truncate dark:text-white",children:e.name}),e.clientName&&(0,r.FD)("p",{className:"text-xs text-stone-500 dark:text-stone-400 flex items-center gap-1",children:[(0,r.Y)(eT.A,{className:"w-3 h-3"}),e.clientName]})]}),d.id===e.id&&(0,r.Y)(ej.A,{className:"w-4 h-4 text-teal-600 dark:text-teal-400 flex-shrink-0 ml-2"})]},e.id)),G&&(0,r.FD)(r.FK,{children:[(0,r.Y)(o.mB,{className:"dark:bg-stone-700"}),(0,r.FD)(o._2,{onClick:()=>x(!0),className:"dark:hover:bg-stone-700 cursor-pointer text-teal-600 dark:text-teal-400",children:[(0,r.Y)(f.A,{className:"w-4 h-4 mr-2"}),"New Project"]})]}),H&&d&&(0,r.FD)(o._2,{onClick:()=>k(!0),className:"dark:hover:bg-stone-700 cursor-pointer",children:[(0,r.Y)(eR.A,{className:"w-4 h-4 mr-2"}),"Allocate to Client"]})]})]}),(0,r.Y)(V.lG,{open:b,onOpenChange:e=>!e&&es(),children:(0,r.FD)(V.Cf,{className:"dark:bg-stone-900 dark:border-stone-700 ".concat(O&&U.length>0?"sm:max-w-[800px]":"sm:max-w-[500px]"),children:[(0,r.FD)(V.c7,{children:[(0,r.Y)(V.L3,{className:"dark:text-white",children:"Create New Project"}),(0,r.Y)(V.rr,{className:"dark:text-stone-400",children:"Select a template to pre-populate tasks, or create an empty project."})]}),(0,r.FD)("div",{className:"flex gap-4 ".concat(O&&U.length>0?"flex-row":"flex-col"),children:[(0,r.FD)("div",{className:"grid gap-4 py-4 ".concat(O&&U.length>0?"w-1/2":"w-full"),children:[(0,r.FD)("div",{className:"grid gap-2",children:[(0,r.FD)(Z.J,{htmlFor:"template",className:"dark:text-stone-200 flex items-center gap-1.5",children:[(0,r.Y)(ek.A,{className:"w-4 h-4"}),"Project Template"]}),(0,r.FD)(F.l6,{value:T||"none",onValueChange:e=>{j("none"===e?"":e),B([])},children:[(0,r.Y)(F.bq,{className:"dark:bg-stone-800 dark:border-stone-700 dark:text-white",children:(0,r.Y)(F.yv,{placeholder:"Select a template..."})}),(0,r.FD)(F.gC,{className:"dark:bg-stone-800 dark:border-stone-700",children:[(0,r.Y)(F.eb,{value:"none",children:(0,r.Y)("span",{className:"text-stone-500",children:"No template (empty project)"})}),u.map(e=>(0,r.Y)(F.eb,{value:String(e.id),children:(0,r.FD)("div",{className:"flex flex-col",children:[(0,r.Y)("span",{children:e.name}),(0,r.FD)("span",{className:"text-xs text-stone-500",children:[e.taskCount," tasks, ~",e.totalDurationDays," days"]})]})},e.id))]})]}),X&&(0,r.FD)("div",{className:"flex items-center justify-between",children:[(0,r.Y)("p",{className:"text-xs text-stone-500 dark:text-stone-400",children:X.description||"".concat(X.taskCount," tasks over ").concat(X.totalDurationDays," days")}),(0,r.FD)(l.$,{type:"button",variant:"ghost",size:"sm",onClick:eo,className:"text-xs text-teal-600 dark:text-teal-400 h-6 px-2",children:[(0,r.Y)(e_.A,{className:"w-3 h-3 mr-1"}),O?"Hide":"Preview"," Tasks"]})]})]}),T&&(0,r.FD)("div",{className:"grid gap-2",children:[(0,r.FD)(Z.J,{htmlFor:"startDate",className:"dark:text-stone-200 flex items-center gap-1.5",children:[(0,r.Y)(eD.A,{className:"w-4 h-4"}),"Project Start Date"]}),(0,r.Y)(Y.p,{id:"startDate",type:"date",value:R,onChange:e=>_(e.target.value),className:"dark:bg-stone-800 dark:border-stone-700 dark:text-white"}),(0,r.Y)("p",{className:"text-xs text-stone-500 dark:text-stone-400",children:"All task dates will be calculated from this start date"})]}),(0,r.FD)("div",{className:"grid gap-2",children:[(0,r.Y)(Z.J,{htmlFor:"name",className:"dark:text-stone-200",children:"Project Name"}),(0,r.Y)(Y.p,{id:"name",value:w,onChange:e=>y(e.target.value),placeholder:"Enter project name",className:"dark:bg-stone-800 dark:border-stone-700 dark:text-white"})]}),(0,r.FD)("div",{className:"grid gap-2",children:[(0,r.FD)(Z.J,{htmlFor:"description",className:"dark:text-stone-200",children:["Description ",(0,r.Y)("span",{className:"text-stone-400 text-xs",children:"(optional)"})]}),(0,r.Y)(Y.p,{id:"description",value:D,onChange:e=>C(e.target.value),placeholder:"Brief project description",className:"dark:bg-stone-800 dark:border-stone-700 dark:text-white"})]}),Q.length>0&&(0,r.FD)("div",{className:"grid gap-2",children:[(0,r.FD)(Z.J,{htmlFor:"projectClient",className:"dark:text-stone-200 flex items-center gap-1.5",children:[(0,r.Y)(eT.A,{className:"w-4 h-4"}),"Assign to Client ",(0,r.Y)("span",{className:"text-stone-400 text-xs",children:"(optional)"})]}),(0,r.FD)(F.l6,{value:M||"none",onValueChange:e=>L("none"===e?"":e),children:[(0,r.Y)(F.bq,{className:"dark:bg-stone-800 dark:border-stone-700 dark:text-white",children:(0,r.Y)(F.yv,{placeholder:"Select a client..."})}),(0,r.FD)(F.gC,{className:"dark:bg-stone-800 dark:border-stone-700",children:[(0,r.Y)(F.eb,{value:"none",children:(0,r.Y)("span",{className:"text-stone-500",children:"No client assigned"})}),Q.map(e=>(0,r.Y)(F.eb,{value:e.id,children:e.name},e.id))]})]})]})]}),O&&T&&(0,r.FD)("div",{className:"w-1/2 border-l border-stone-200 dark:border-stone-700 pl-4 py-4",children:[(0,r.FD)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.Y)("h4",{className:"text-sm font-medium dark:text-white",children:"Task Preview"}),(0,r.FD)(eN.E,{variant:"secondary",className:"text-xs",children:[U.length," tasks"]})]}),q?(0,r.Y)("div",{className:"flex items-center justify-center h-40",children:(0,r.Y)(el.A,{className:"w-6 h-6 animate-spin text-teal-600"})}):(0,r.Y)(ee,{className:"h-[350px] pr-3",children:(0,r.Y)("div",{className:"space-y-2",children:U.map((e,t)=>(0,r.Y)("div",{className:"p-2 bg-stone-50 dark:bg-stone-800 rounded-md border border-stone-200 dark:border-stone-700",children:(0,r.FD)("div",{className:"flex items-start gap-2",children:[(0,r.FD)("span",{className:"text-xs text-stone-400 dark:text-stone-500 w-5 flex-shrink-0",children:[t+1,"."]}),(0,r.FD)("div",{className:"flex-1 min-w-0",children:[(0,r.FD)("div",{className:"flex items-center gap-1.5",children:[(0,r.Y)("span",{className:"text-sm font-medium dark:text-white truncate",children:e.name}),e.isMilestone&&(0,r.Y)(ey.A,{className:"w-3 h-3 text-orange-500 flex-shrink-0"})]}),(0,r.FD)("div",{className:"flex items-center gap-2 mt-1 text-xs text-stone-500 dark:text-stone-400",children:[(0,r.FD)("span",{className:"flex items-center gap-0.5",children:[(0,r.Y)(eD.A,{className:"w-3 h-3"}),ed(e.daysFromStart)]}),(0,r.FD)("span",{className:"flex items-center gap-0.5",children:[(0,r.Y)(v.A,{className:"w-3 h-3"}),e.durationDays,"d"]}),"medium"!==e.priority&&(0,r.Y)(eN.E,{variant:"outline",className:"text-[10px] px-1 py-0 h-4 ".concat("critical"===e.priority?"border-red-500 text-red-500":"high"===e.priority?"border-orange-500 text-orange-500":"border-stone-400 text-stone-400"),children:e.priority})]})]})]})},e.id))})})]})]}),(0,r.FD)(V.Es,{children:[(0,r.Y)(l.$,{variant:"outline",onClick:es,className:"dark:border-stone-600 dark:text-stone-300",children:"Cancel"}),(0,r.Y)(l.$,{onClick:er,disabled:E||!w.trim(),className:"bg-teal-600 hover:bg-teal-700 text-white",children:E?(0,r.FD)(r.FK,{children:[(0,r.Y)(el.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating..."]}):T?"Create with ".concat((null==X?void 0:X.taskCount)||0," Tasks"):"Create Empty Project"})]})]})}),(0,r.Y)(V.lG,{open:N,onOpenChange:k,children:(0,r.FD)(V.Cf,{className:"sm:max-w-[425px] dark:bg-stone-900 dark:border-stone-700",children:[(0,r.FD)(V.c7,{children:[(0,r.Y)(V.L3,{className:"dark:text-white",children:"Allocate to Client"}),(0,r.Y)(V.rr,{className:"dark:text-stone-400",children:"Assign this project to a client so they can view progress."})]}),(0,r.FD)("div",{className:"grid gap-4 py-4",children:[(0,r.FD)("div",{className:"grid gap-2",children:[(0,r.Y)(Z.J,{className:"dark:text-stone-200",children:"Project"}),(0,r.Y)("p",{className:"text-sm text-stone-600 dark:text-stone-400",children:null==d?void 0:d.name})]}),(0,r.FD)("div",{className:"grid gap-2",children:[(0,r.Y)(Z.J,{htmlFor:"client",className:"dark:text-stone-200",children:"Select Client"}),(0,r.FD)(F.l6,{value:S||"none",onValueChange:e=>A("none"===e?"":e),children:[(0,r.Y)(F.bq,{className:"dark:bg-stone-800 dark:border-stone-700 dark:text-white",children:(0,r.Y)(F.yv,{placeholder:"Choose a client..."})}),(0,r.FD)(F.gC,{className:"dark:bg-stone-800 dark:border-stone-700",children:[(0,r.Y)(F.eb,{value:"none",children:"No client"}),Q.map(e=>(0,r.Y)(F.eb,{value:e.id,children:e.name},e.id))]})]})]})]}),(0,r.FD)(V.Es,{children:[(0,r.Y)(l.$,{variant:"outline",onClick:()=>k(!1),className:"dark:border-stone-600 dark:text-stone-300",children:"Cancel"}),(0,r.Y)(l.$,{onClick:en,disabled:z,className:"bg-teal-600 hover:bg-teal-700 text-white",children:z?(0,r.FD)(r.FK,{children:[(0,r.Y)(el.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Allocating..."]}):"Allocate"})]})]})})]}):(0,r.FD)(l.$,{variant:"outline",size:"sm",onClick:()=>G&&x(!0),className:"border-stone-300 dark:border-stone-600 text-stone-600 dark:text-stone-300",children:[(0,r.Y)(eA.A,{className:"w-4 h-4 mr-1.5"}),"No Project"]})}var eL=a(4581),eE=a(7280),eI=a(5675),ez=a(7605);function eJ(){let{user:e,currentProject:t,loading:s}=(0,ea.A)(),o=t?Number(t.id):null,{tasks:d,loading:i,error:c,refetch:h,createTask:u,updateTask:p,deleteTask:g,reorderTasks:f}=(0,eL.i)(o),[x,N]=(0,n.useState)([]),[k,v]=(0,n.useState)([]),w=x.length>0,y=k.length>0,[Y,F]=(0,n.useState)("week"),[C,S]=(0,n.useState)("all"),[A,j]=(0,n.useState)(""),[R,_]=(0,n.useState)(!1),[M,P]=(0,n.useState)(!1),[L,E]=(0,n.useState)(!1),[I,z]=(0,n.useState)(null),[J,O]=(0,n.useState)(!1),[$,U]=(0,n.useState)(!1),[B,q]=(0,n.useState)(null),{theme:K,setTheme:V,resolvedTheme:Z}=(0,eE.D)(),H=(0,n.useRef)(null);(0,n.useEffect)(()=>{q(eg())},[]),(0,n.useEffect)(()=>{c&&ei.oR.error("Failed to load tasks: ".concat(c))},[c]);let Q=(null==t?void 0:t.name)||(null==B?void 0:B.defaultProjectName)||"OCF Bond Issuance Project",W=(null==t?void 0:t.description)||(null==B?void 0:B.defaultProjectDescription)||"Project Timeline & Task Management",X=(0,n.useMemo)(()=>{if(!A.trim())return d;let e=A.toLowerCase();return d.filter(t=>t.name.toLowerCase().includes(e))},[d,A]),ee=!e||(0,eM.DX)(e.role),et=!e||(0,eM.MF)(e.role),er=!!e&&(0,eM.zb)(e.role),es=(0,n.useCallback)(()=>{N(e=>[...e.slice(-49),d]),v([])},[d]);(0,n.useEffect)(()=>{let e=e=>{!(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement)&&((e.ctrlKey||e.metaKey)&&"n"===e.key&&(e.preventDefault(),ee&&en()),(e.ctrlKey||e.metaKey)&&"d"===e.key&&(e.preventDefault(),_(e=>!e)),(e.ctrlKey||e.metaKey)&&"k"===e.key&&(e.preventDefault(),P(e=>!e)),"1"===e.key&&F("day"),"2"===e.key&&F("week"),"3"===e.key&&F("month"),"Escape"===e.key&&L&&E(!1))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[L,ee]);let en=()=>{z(null),E(!0)},eo=async e=>{es(),I?await p(e)?ei.oR.success("Task updated"):ei.oR.error("Failed to update task"):await u(e)?ei.oR.success("Task added"):ei.oR.error("Failed to add task")},ed=async e=>{es(),await g(e)?ei.oR.success("Task deleted"):ei.oR.error("Failed to delete task")},em=async e=>{await f(e)},eh=async()=>{try{let e=(await a.e(316).then(a.t.bind(a,2699,23))).default,t=document.getElementById("gantt-chart-container");if(!t)return;let r=await e(t,{backgroundColor:"dark"===Z?"#1c1917":"#fafaf9",scale:2}),s=document.createElement("a");s.download="".concat(Q.replace(/\s+/g,"-").toLowerCase(),"-gantt.png"),s.href=r.toDataURL("image/png"),s.click(),ei.oR.success("Chart exported as PNG")}catch(e){ei.oR.error("Failed to export PNG")}},eu=async()=>{await h(),j(""),ei.oR.success("Tasks refreshed from server")},ep=s||i;return(0,r.FD)("div",{className:"space-y-6",children:[(0,r.FD)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[(0,r.FD)("div",{children:[(0,r.Y)("h1",{className:"text-2xl md:text-3xl font-bold text-stone-800 dark:text-white",children:"Project Timeline"}),(0,r.Y)("p",{className:"text-stone-500 dark:text-stone-400 mt-1",children:W})]}),(0,r.FD)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,r.Y)(eP,{}),ep&&(0,r.Y)(el.A,{className:"w-4 h-4 animate-spin text-teal-600"}),er&&(0,r.FD)(l.$,{variant:"outline",size:"sm",onClick:()=>U(!0),className:"border-stone-300 dark:border-stone-600 text-stone-600 dark:text-stone-300 hover:bg-stone-100 dark:hover:bg-stone-700",title:"Manage Templates",children:[(0,r.Y)(ek.A,{className:"w-4 h-4 mr-1.5"}),(0,r.Y)("span",{className:"hidden sm:inline",children:"Templates"})]}),(0,r.FD)("div",{className:"flex items-center border-r border-stone-200 dark:border-stone-700 pr-2 mr-1",children:[(0,r.Y)(l.$,{variant:"ghost",size:"sm",onClick:()=>{x.length>0&&(v(e=>[...e,d]),N(e=>e.slice(0,-1)),ei.oR.info("Undo (local only - refresh to sync with server)"))},disabled:!w,className:"text-stone-500 dark:text-stone-400 hover:text-stone-700 dark:hover:text-stone-200 disabled:opacity-30",title:"Undo",children:(0,r.Y)(eI.A,{className:"w-4 h-4"})}),(0,r.Y)(l.$,{variant:"ghost",size:"sm",onClick:()=>{k.length>0&&(N(e=>[...e,d]),v(e=>e.slice(0,-1)),ei.oR.info("Redo (local only - refresh to sync with server)"))},disabled:!y,className:"text-stone-500 dark:text-stone-400 hover:text-stone-700 dark:hover:text-stone-200 disabled:opacity-30",title:"Redo",children:(0,r.Y)(ez.A,{className:"w-4 h-4"})})]}),(0,r.Y)(l.$,{variant:"outline",size:"sm",onClick:eu,className:"border-stone-300 dark:border-stone-600 text-stone-600 dark:text-stone-300",children:(0,r.Y)(m.A,{className:"w-4 h-4"})})]})]}),(0,r.Y)(b,{projectName:Q,projectDescription:W,onAddTask:ee?en:()=>ei.oR.error("You do not have permission to add tasks"),onExportPNG:eh,onExportJSON:()=>{let e=new Blob([JSON.stringify(d,null,2)],{type:"application/json"}),t=document.createElement("a");t.download="".concat(Q.replace(/\s+/g,"-").toLowerCase(),"-tasks.json"),t.href=URL.createObjectURL(e),t.click(),ei.oR.success("Tasks exported as JSON")},onImportJSON:()=>{ei.oR.info("Import from JSON is disabled when using the database backend")},onRefresh:eu,theme:K,resolvedTheme:Z,onThemeChange:e=>{V(e)},onOpenSettings:()=>O(!0),settings:B||void 0}),(0,r.Y)(D,{tasks:d}),(0,r.FD)("div",{id:"gantt-chart-container",ref:H,className:"rounded-xl overflow-hidden shadow-lg",children:[(0,r.Y)(T,{zoom:Y,onZoomChange:F,filter:C,onFilterChange:S,showDependencies:R,onShowDependenciesChange:_,showCriticalPath:M,onShowCriticalPathChange:P,searchQuery:A,onSearchChange:j}),(0,r.Y)("div",{className:"h-[calc(100vh-520px)] min-h-[400px]",children:ep?(0,r.Y)("div",{className:"h-full flex items-center justify-center bg-stone-50 dark:bg-stone-800",children:(0,r.FD)("div",{className:"text-center",children:[(0,r.Y)(el.A,{className:"w-8 h-8 animate-spin text-teal-600 mx-auto mb-2"}),(0,r.Y)("p",{className:"text-stone-500 dark:text-stone-400",children:"Loading tasks..."})]})}):(0,r.Y)(G,{tasks:X,allTasks:d,zoom:Y,filter:C,showDependencies:R,showCriticalPath:M,onTaskClick:et?e=>{z(e),E(!0)}:void 0,onReorderTasks:em,projectName:Q})})]}),(0,r.Y)("footer",{className:"text-center text-sm text-stone-500 dark:text-stone-400",children:(0,r.Y)("p",{className:"text-xs",children:"Shortcuts: 1/2/3 = Zoom | Ctrl+N = New Task | Ctrl+D = Dependencies | Ctrl+K = Critical Path"})}),(0,r.Y)(ec,{open:L,onOpenChange:E,task:I,tasks:d,onSave:eo,onDelete:ed}),(0,r.Y)(ex,{open:J,onOpenChange:O,onSettingsChange:e=>{q(e),ei.oR.success("Settings saved")}}),(0,r.Y)(eS,{open:$,onOpenChange:U})]})}function eO(){let{resolvedTheme:e}=(0,eE.D)();return(0,r.FD)(r.FK,{children:[(0,r.Y)(ei.l$,{position:"top-right",richColors:!0,theme:"dark"===e?"dark":"light"}),(0,r.Y)(s.t,{children:(0,r.Y)(eJ,{})})]})}},4581:(e,t,a)=>{"use strict";a.d(t,{i:()=>o});var r=a(2115),s=a(5731);function n(e){var t;return{id:String(e.id),name:e.name,startDate:new Date(e.start_date),endDate:new Date(e.end_date),progress:e.progress,status:e.status,isMilestone:e.is_milestone,order:e.task_order,dependencies:null==(t=e.dependencies)?void 0:t.map(String),parentId:e.parent_id?String(e.parent_id):void 0,notes:e.notes||void 0,color:e.color||void 0}}function l(e,t){var a;return{project_id:t,name:e.name,description:"",notes:e.notes||"",start_date:e.startDate instanceof Date?e.startDate.toISOString().split("T")[0]:new Date(e.startDate).toISOString().split("T")[0],end_date:e.endDate instanceof Date?e.endDate.toISOString().split("T")[0]:new Date(e.endDate).toISOString().split("T")[0],progress:e.progress,status:e.status,is_milestone:e.isMilestone||!1,task_order:e.order,dependencies:null==(a=e.dependencies)?void 0:a.map(Number).filter(e=>!isNaN(e)),parent_id:e.parentId?Number(e.parentId):null,color:e.color||null}}function o(e){let[t,a]=(0,r.useState)([]),[o,d]=(0,r.useState)(!0),[i,c]=(0,r.useState)(null),m=(0,r.useCallback)(async()=>{if(!e){a([]),d(!1);return}d(!0),c(null);let t=await s.bI.getByProject(e);if(t.success&&t.data){let e=t.data.map(n);e.sort((e,t)=>{let a=new Date(e.startDate).getTime()-new Date(t.startDate).getTime();return 0!==a?a:new Date(e.endDate).getTime()-new Date(t.endDate).getTime()}),a(e)}else c(t.error||"Failed to fetch tasks"),a([]);d(!1)},[e]);(0,r.useEffect)(()=>{m()},[m]);let h=e=>[...e].sort((e,t)=>{let a=new Date(e.startDate).getTime()-new Date(t.startDate).getTime();return 0!==a?a:new Date(e.endDate).getTime()-new Date(t.endDate).getTime()}),u=(0,r.useCallback)(async t=>{if(!e)return null;let r=l(t,e),o=await s.bI.create(r);if(o.success&&o.data){let e=n(o.data);return a(t=>h([...t,e])),e}return c(o.error||"Failed to create task"),null},[e]),p=(0,r.useCallback)(async t=>{if(!e)return null;let r=Number(t.id);if(isNaN(r))return c("Invalid task ID"),null;let o=l(t,e),d=await s.bI.update(r,o);if(d.success&&d.data){let e=n(d.data);return a(a=>h(a.map(a=>a.id===t.id?e:a))),e}return c(d.error||"Failed to update task"),null},[e]);return{tasks:t,loading:o,error:i,refetch:m,createTask:u,updateTask:p,deleteTask:(0,r.useCallback)(async e=>{let t=Number(e);if(isNaN(t))return c("Invalid task ID"),!1;let r=await s.bI.delete(t);return r.success?(a(t=>t.filter(t=>t.id!==e)),!0):(c(r.error||"Failed to delete task"),!1)},[]),reorderTasks:(0,r.useCallback)(async t=>{if(!e)return;let r=h(t).map((e,t)=>({...e,order:t+1}));a(r);let n=r.map(e=>({id:Number(e.id),order:e.order})).filter(e=>!isNaN(e.id));await s.bI.reorder(e,n)},[e])}}},4838:(e,t,a)=>{"use strict";a.d(t,{SQ:()=>h,_2:()=>u,lp:()=>p,mB:()=>g,rI:()=>c,ty:()=>m});var r=a(2372),s=a(2115),n=a(6215),l=a(3158),o=a(518),d=a(154),i=a(9434);let c=n.bL,m=n.l9;n.YJ,n.ZL,n.Pb,n.z6,s.forwardRef((e,t)=>{let{className:a,inset:s,children:o,...d}=e;return(0,r.FD)(n.ZP,{ref:t,className:(0,i.cn)("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s&&"pl-8",a),...d,children:[o,(0,r.Y)(l.A,{className:"ml-auto"})]})}).displayName=n.ZP.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(n.G5,{ref:t,className:(0,i.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",a),...s})}).displayName=n.G5.displayName;let h=s.forwardRef((e,t)=>{let{className:a,sideOffset:s=4,...l}=e;return(0,r.Y)(n.ZL,{children:(0,r.Y)(n.UC,{ref:t,sideOffset:s,className:(0,i.cn)("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",a),...l})})});h.displayName=n.UC.displayName;let u=s.forwardRef((e,t)=>{let{className:a,inset:s,...l}=e;return(0,r.Y)(n.q7,{ref:t,className:(0,i.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",s&&"pl-8",a),...l})});u.displayName=n.q7.displayName,s.forwardRef((e,t)=>{let{className:a,children:s,checked:l,...d}=e;return(0,r.FD)(n.H_,{ref:t,className:(0,i.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:l,...d,children:[(0,r.Y)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.Y)(n.VF,{children:(0,r.Y)(o.A,{className:"h-4 w-4"})})}),s]})}).displayName=n.H_.displayName,s.forwardRef((e,t)=>{let{className:a,children:s,...l}=e;return(0,r.FD)(n.hN,{ref:t,className:(0,i.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,r.Y)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.Y)(n.VF,{children:(0,r.Y)(d.A,{className:"h-2 w-2 fill-current"})})}),s]})}).displayName=n.hN.displayName;let p=s.forwardRef((e,t)=>{let{className:a,inset:s,...l}=e;return(0,r.Y)(n.JU,{ref:t,className:(0,i.cn)("px-2 py-1.5 text-sm font-semibold",s&&"pl-8",a),...l})});p.displayName=n.JU.displayName;let g=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(n.wv,{ref:t,className:(0,i.cn)("-mx-1 my-1 h-px bg-muted",a),...s})});g.displayName=n.wv.displayName},5057:(e,t,a)=>{"use strict";a.d(t,{J:()=>i});var r=a(2372),s=a(2115),n=a(2797),l=a(2085),o=a(9434);let d=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(n.b,{ref:t,className:(0,o.cn)(d(),a),...s})});i.displayName=n.b.displayName},7262:(e,t,a)=>{"use strict";a.d(t,{S:()=>d});var r=a(2372),s=a(2115),n=a(6981),l=a(518),o=a(9434);let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(n.bL,{ref:t,className:(0,o.cn)("grid place-content-center peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...s,children:(0,r.Y)(n.C1,{className:(0,o.cn)("grid place-content-center text-current"),children:(0,r.Y)(l.A,{className:"h-4 w-4"})})})});d.displayName=n.bL.displayName},7313:(e,t,a)=>{"use strict";a.d(t,{Xi:()=>i,av:()=>c,j7:()=>d,tU:()=>o});var r=a(2372),s=a(2115),n=a(704),l=a(9434);let o=n.bL,d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(n.B8,{ref:t,className:(0,l.cn)("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",a),...s})});d.displayName=n.B8.displayName;let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(n.l9,{ref:t,className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",a),...s})});i.displayName=n.l9.displayName;let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(n.UC,{ref:t,className:(0,l.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...s})});c.displayName=n.UC.displayName},8539:(e,t,a)=>{"use strict";a.d(t,{T:()=>l});var r=a(2372),s=a(2115),n=a(9434);let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)("textarea",{className:(0,n.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...s})});l.displayName="Textarea"},9409:(e,t,a)=>{"use strict";a.d(t,{bq:()=>h,eb:()=>f,gC:()=>g,l6:()=>c,yv:()=>m});var r=a(2372),s=a(2115),n=a(3433),l=a(9556),o=a(7381),d=a(518),i=a(9434);let c=n.bL;n.YJ;let m=n.WT,h=s.forwardRef((e,t)=>{let{className:a,children:s,...o}=e;return(0,r.FD)(n.l9,{ref:t,className:(0,i.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...o,children:[s,(0,r.Y)(n.In,{asChild:!0,children:(0,r.Y)(l.A,{className:"h-4 w-4 opacity-50"})})]})});h.displayName=n.l9.displayName;let u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(n.PP,{ref:t,className:(0,i.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.Y)(o.A,{className:"h-4 w-4"})})});u.displayName=n.PP.displayName;let p=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(n.wn,{ref:t,className:(0,i.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.Y)(l.A,{className:"h-4 w-4"})})});p.displayName=n.wn.displayName;let g=s.forwardRef((e,t)=>{let{className:a,children:s,position:l="popper",...o}=e;return(0,r.Y)(n.ZL,{children:(0,r.FD)(n.UC,{ref:t,className:(0,i.cn)("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l,...o,children:[(0,r.Y)(u,{}),(0,r.Y)(n.LM,{className:(0,i.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,r.Y)(p,{})]})})});g.displayName=n.UC.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(n.JU,{ref:t,className:(0,i.cn)("px-2 py-1.5 text-sm font-semibold",a),...s})}).displayName=n.JU.displayName;let f=s.forwardRef((e,t)=>{let{className:a,children:s,...l}=e;return(0,r.FD)(n.q7,{ref:t,className:(0,i.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,r.Y)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.Y)(n.VF,{children:(0,r.Y)(d.A,{className:"h-4 w-4"})})}),(0,r.Y)(n.p4,{children:s})]})});f.displayName=n.q7.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(n.wv,{ref:t,className:(0,i.cn)("-mx-1 my-1 h-px bg-muted",a),...s})}).displayName=n.wv.displayName}},e=>{var t=t=>e(e.s=t);e.O(0,[372,9,726,434,671,440,832,965,924,190,441,684,358],()=>t(2773)),_N_E=e.O()}]);