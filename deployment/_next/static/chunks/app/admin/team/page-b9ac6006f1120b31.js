(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[126],{2523:(e,t,a)=>{"use strict";a.d(t,{p:()=>n});var r=a(2372),s=a(2115),l=a(9434);let n=s.forwardRef((e,t)=>{let{className:a,type:s,...n}=e;return(0,r.Y)("input",{type:s,className:(0,l.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...n})});n.displayName="Input"},5057:(e,t,a)=>{"use strict";a.d(t,{J:()=>d});var r=a(2372),s=a(2115),l=a(2797),n=a(2085),i=a(9434);let o=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(l.b,{ref:t,className:(0,i.cn)(o(),a),...s})});d.displayName=l.b.displayName},5127:(e,t,a)=>{"use strict";a.d(t,{A0:()=>i,BF:()=>o,Hj:()=>d,XI:()=>n,nA:()=>m,nd:()=>c});var r=a(2372),s=a(2115),l=a(9434);let n=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)("div",{className:"relative w-full overflow-auto",children:(0,r.Y)("table",{ref:t,className:(0,l.cn)("w-full caption-bottom text-sm",a),...s})})});n.displayName="Table";let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)("thead",{ref:t,className:(0,l.cn)("[&_tr]:border-b",a),...s})});i.displayName="TableHeader";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)("tbody",{ref:t,className:(0,l.cn)("[&_tr:last-child]:border-0",a),...s})});o.displayName="TableBody",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)("tfoot",{ref:t,className:(0,l.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...s})}).displayName="TableFooter";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)("tr",{ref:t,className:(0,l.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...s})});d.displayName="TableRow";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)("th",{ref:t,className:(0,l.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...s})});c.displayName="TableHead";let m=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)("td",{ref:t,className:(0,l.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...s})});m.displayName="TableCell",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)("caption",{ref:t,className:(0,l.cn)("mt-4 text-sm text-muted-foreground",a),...s})}).displayName="TableCaption"},7262:(e,t,a)=>{"use strict";a.d(t,{S:()=>o});var r=a(2372),s=a(2115),l=a(6981),n=a(518),i=a(9434);let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(l.bL,{ref:t,className:(0,i.cn)("grid place-content-center peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...s,children:(0,r.Y)(l.C1,{className:(0,i.cn)("grid place-content-center text-current"),children:(0,r.Y)(n.A,{className:"h-4 w-4"})})})});o.displayName=l.bL.displayName},7313:(e,t,a)=>{"use strict";a.d(t,{Xi:()=>d,av:()=>c,j7:()=>o,tU:()=>i});var r=a(2372),s=a(2115),l=a(704),n=a(9434);let i=l.bL,o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(l.B8,{ref:t,className:(0,n.cn)("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",a),...s})});o.displayName=l.B8.displayName;let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(l.l9,{ref:t,className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",a),...s})});d.displayName=l.l9.displayName;let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(l.UC,{ref:t,className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...s})});c.displayName=l.UC.displayName},8539:(e,t,a)=>{"use strict";a.d(t,{T:()=>n});var r=a(2372),s=a(2115),l=a(9434);let n=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)("textarea",{className:(0,l.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...s})});n.displayName="Textarea"},9138:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>H});var r=a(2372),s=a(2115),l=a(4541),n=a(4399),i=a(6695),o=a(285),d=a(2523),c=a(5057),m=a(8539),h=a(6126),u=a(7262),p=a(4165),f=a(9409),g=a(5127),b=a(172),x=a(286),N=a(3896),v=a(462),y=a(8763),w=a(7223),Y=a(9311),k=a(6923),F=a(5318),D=a(5695),C=a(6671),A=a(7280),R=a(3833);a(4534);var j=a(4073),_=a(9434);function S(e){let{className:t,defaultValue:a,value:l,min:n=0,max:i=100,...o}=e,d=s.useMemo(()=>{var e;return null!=(e=null!=l?l:a)?e:[n,i]},[l,a,n,i]);return(0,r.FD)(j.bL,{"data-slot":"slider",defaultValue:a,value:l,min:n,max:i,className:(0,_.cn)("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",t),...o,children:[(0,r.Y)(j.CC,{"data-slot":"slider-track",className:(0,_.cn)("bg-stone-200 dark:bg-stone-700 relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:(0,r.Y)(j.Q6,{"data-slot":"slider-range",className:(0,_.cn)("bg-teal-600 absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:d.length},(e,t)=>(0,r.Y)(j.zi,{"data-slot":"slider-thumb",className:"border-teal-600 bg-white ring-offset-white focus-visible:ring-teal-500 dark:border-teal-500 dark:bg-stone-900 dark:ring-offset-stone-900 dark:focus-visible:ring-teal-400 block size-4 shrink-0 rounded-full border-2 shadow-sm transition-colors focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},t))]})}var T=a(4884);let P=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(T.bL,{className:(0,_.cn)("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...s,ref:t,children:(0,r.Y)(T.zi,{className:(0,_.cn)("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})})});P.displayName=T.bL.displayName;var J=a(7313),E=a(799),z=a(6936),L=a(154),U=a(8061),M=a(8531),$=a(4244),O=a(2733),I=a(518);let G={brightness:100,contrast:100,saturation:100};function B(e){let{open:t,onOpenChange:a,imageSrc:l,onCropComplete:n,aspectRatio:i=1,circularCrop:d=!1,maxOutputSize:m=400,outputFormat:h="image/jpeg",outputQuality:u=.9}=e,f=(0,s.useRef)(null),[g,x]=(0,s.useState)(),[N,v]=(0,s.useState)(),[y,w]=(0,s.useState)(1),[Y,k]=(0,s.useState)(0),[D,C]=(0,s.useState)(!1),[A,j]=(0,s.useState)(d),[_,T]=(0,s.useState)(G),[B,V]=(0,s.useState)("crop"),W=(0,s.useCallback)(e=>{let{width:t,height:a}=e.currentTarget;x((0,R.ge)((0,R.dS)({unit:"%",width:90},i,t,a),t,a))},[i]),H=()=>{w(1),k(0)},K=()=>{T(G)},X=()=>{H(),K(),j(d)},q=()=>"brightness(".concat(_.brightness,"%) contrast(").concat(_.contrast,"%) saturate(").concat(_.saturation,"%)"),Q=async()=>{if(N&&f.current){C(!0);try{let e=f.current,t=document.createElement("canvas"),r=t.getContext("2d");if(!r)throw Error("No 2d context");let s=e.naturalWidth/e.width,l=e.naturalHeight/e.height,i={x:N.x*s,y:N.y*l,width:N.width*s,height:N.height*l},o=i.width,d=i.height;if(o>m||d>m){let e=Math.min(m/o,m/d);o=Math.round(o*e),d=Math.round(d*e)}if(t.width=o,t.height=d,r.imageSmoothingEnabled=!0,r.imageSmoothingQuality="high",r.filter=q(),0!==Y){let e=o/2,t=d/2;r.translate(e,t),r.rotate(Y*Math.PI/180),r.translate(-e,-t)}r.drawImage(e,i.x,i.y,i.width,i.height,0,0,o,d),r.filter="none",A&&(r.globalCompositeOperation="destination-in",r.beginPath(),r.arc(o/2,d/2,Math.min(o,d)/2,0,2*Math.PI),r.fill());let c=t.toDataURL(h,u);n(c),a(!1)}catch(e){console.error("Error cropping image:",e)}finally{C(!1)}}};return(0,r.Y)(p.lG,{open:t,onOpenChange:a,children:(0,r.FD)(p.Cf,{className:"sm:max-w-[650px] max-h-[90vh] overflow-y-auto bg-white dark:bg-stone-900 border-stone-200 dark:border-stone-700",children:[(0,r.FD)(p.c7,{children:[(0,r.Y)(p.L3,{className:"text-stone-800 dark:text-white",children:"Edit Image"}),(0,r.Y)(p.rr,{className:"text-stone-500 dark:text-stone-400",children:"Crop, rotate, and adjust your image before uploading."})]}),(0,r.FD)(J.tU,{value:B,onValueChange:V,className:"w-full",children:[(0,r.FD)(J.j7,{className:"grid w-full grid-cols-2 bg-stone-100 dark:bg-stone-800",children:[(0,r.FD)(J.Xi,{value:"crop",className:"text-sm",children:[(0,r.Y)(E.A,{className:"h-4 w-4 mr-2"}),"Crop & Transform"]}),(0,r.FD)(J.Xi,{value:"filters",className:"text-sm",children:[(0,r.Y)(z.A,{className:"h-4 w-4 mr-2"}),"Filters"]})]}),(0,r.FD)("div",{className:"mt-4",children:[(0,r.Y)("div",{className:"relative flex items-center justify-center bg-stone-100 dark:bg-stone-800 rounded-lg overflow-hidden min-h-[280px] mb-4",children:(0,r.Y)(R.Ay,{crop:g,onChange:(e,t)=>x(t),onComplete:e=>v(e),aspect:i,circularCrop:A,className:"max-h-[350px]",children:(0,r.Y)("img",{ref:f,alt:"Crop preview",src:l,style:{transform:"scale(".concat(y,") rotate(").concat(Y,"deg)"),filter:q(),maxHeight:"350px",maxWidth:"100%"},onLoad:W})})}),(0,r.FD)(J.av,{value:"crop",className:"space-y-4 mt-0",children:[(0,r.FD)("div",{className:"flex items-center justify-between p-3 bg-stone-50 dark:bg-stone-800 rounded-lg",children:[(0,r.FD)("div",{className:"flex items-center gap-2",children:[A?(0,r.Y)(L.A,{className:"h-4 w-4 text-teal-600"}):(0,r.Y)(U.A,{className:"h-4 w-4 text-stone-500"}),(0,r.Y)(c.J,{htmlFor:"circular-crop",className:"text-stone-700 dark:text-stone-300 cursor-pointer",children:"Circular Crop"})]}),(0,r.Y)(P,{id:"circular-crop",checked:A,onCheckedChange:j})]}),(0,r.FD)("div",{className:"space-y-2",children:[(0,r.FD)("div",{className:"flex items-center justify-between",children:[(0,r.FD)(c.J,{className:"text-stone-700 dark:text-stone-300 flex items-center gap-2",children:[(0,r.Y)(E.A,{className:"h-4 w-4"}),"Zoom"]}),(0,r.FD)("span",{className:"text-sm text-stone-500 font-mono",children:[Math.round(100*y),"%"]})]}),(0,r.Y)(S,{value:[y],onValueChange:e=>w(e[0]),min:.5,max:3,step:.05,className:"w-full"})]}),(0,r.FD)("div",{className:"space-y-2",children:[(0,r.FD)("div",{className:"flex items-center justify-between",children:[(0,r.FD)(c.J,{className:"text-stone-700 dark:text-stone-300 flex items-center gap-2",children:[(0,r.Y)(M.A,{className:"h-4 w-4"}),"Rotate"]}),(0,r.FD)("span",{className:"text-sm text-stone-500 font-mono",children:[Y,"\xb0"]})]}),(0,r.Y)(S,{value:[Y],onValueChange:e=>k(e[0]),min:-180,max:180,step:1,className:"w-full"})]}),(0,r.FD)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,r.FD)(o.$,{type:"button",variant:"outline",size:"sm",onClick:H,className:"text-stone-600 dark:text-stone-300",children:[(0,r.Y)(M.A,{className:"h-4 w-4 mr-1"}),"Reset"]}),(0,r.Y)(o.$,{type:"button",variant:"outline",size:"sm",onClick:()=>k(e=>e-90),className:"text-stone-600 dark:text-stone-300",children:"↺ 90\xb0"}),(0,r.Y)(o.$,{type:"button",variant:"outline",size:"sm",onClick:()=>k(e=>e+90),className:"text-stone-600 dark:text-stone-300",children:"↻ 90\xb0"})]})]}),(0,r.FD)(J.av,{value:"filters",className:"space-y-4 mt-0",children:[(0,r.FD)("div",{className:"space-y-2",children:[(0,r.FD)("div",{className:"flex items-center justify-between",children:[(0,r.FD)(c.J,{className:"text-stone-700 dark:text-stone-300 flex items-center gap-2",children:[(0,r.Y)(z.A,{className:"h-4 w-4"}),"Brightness"]}),(0,r.FD)("span",{className:"text-sm text-stone-500 font-mono",children:[_.brightness,"%"]})]}),(0,r.Y)(S,{value:[_.brightness],onValueChange:e=>T({..._,brightness:e[0]}),min:50,max:150,step:1,className:"w-full"})]}),(0,r.FD)("div",{className:"space-y-2",children:[(0,r.FD)("div",{className:"flex items-center justify-between",children:[(0,r.FD)(c.J,{className:"text-stone-700 dark:text-stone-300 flex items-center gap-2",children:[(0,r.Y)($.A,{className:"h-4 w-4"}),"Contrast"]}),(0,r.FD)("span",{className:"text-sm text-stone-500 font-mono",children:[_.contrast,"%"]})]}),(0,r.Y)(S,{value:[_.contrast],onValueChange:e=>T({..._,contrast:e[0]}),min:50,max:150,step:1,className:"w-full"})]}),(0,r.FD)("div",{className:"space-y-2",children:[(0,r.FD)("div",{className:"flex items-center justify-between",children:[(0,r.FD)(c.J,{className:"text-stone-700 dark:text-stone-300 flex items-center gap-2",children:[(0,r.Y)(O.A,{className:"h-4 w-4"}),"Saturation"]}),(0,r.FD)("span",{className:"text-sm text-stone-500 font-mono",children:[_.saturation,"%"]})]}),(0,r.Y)(S,{value:[_.saturation],onValueChange:e=>T({..._,saturation:e[0]}),min:0,max:200,step:1,className:"w-full"})]}),(0,r.FD)("div",{className:"space-y-2",children:[(0,r.Y)(c.J,{className:"text-stone-700 dark:text-stone-300 text-sm",children:"Quick Presets"}),(0,r.FD)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,r.Y)(o.$,{type:"button",variant:"outline",size:"sm",onClick:K,className:"text-stone-600 dark:text-stone-300",children:"Normal"}),(0,r.Y)(o.$,{type:"button",variant:"outline",size:"sm",onClick:()=>T({brightness:110,contrast:110,saturation:90}),className:"text-stone-600 dark:text-stone-300",children:"Vivid"}),(0,r.Y)(o.$,{type:"button",variant:"outline",size:"sm",onClick:()=>T({brightness:105,contrast:95,saturation:0}),className:"text-stone-600 dark:text-stone-300",children:"B&W"}),(0,r.Y)(o.$,{type:"button",variant:"outline",size:"sm",onClick:()=>T({brightness:95,contrast:105,saturation:80}),className:"text-stone-600 dark:text-stone-300",children:"Muted"}),(0,r.Y)(o.$,{type:"button",variant:"outline",size:"sm",onClick:()=>T({brightness:100,contrast:120,saturation:110}),className:"text-stone-600 dark:text-stone-300",children:"Pop"})]})]})]})]})]}),(0,r.FD)("p",{className:"text-xs text-stone-500 dark:text-stone-400 mt-2",children:["Output: ",m,"\xd7",m,"px max, ",h.replace("image/","").toUpperCase()," format",A&&" (circular)"]}),(0,r.FD)(p.Es,{className:"mt-4",children:[(0,r.FD)(o.$,{variant:"outline",onClick:()=>{X(),a(!1)},className:"border-stone-200 dark:border-stone-700",children:[(0,r.Y)(F.A,{className:"h-4 w-4 mr-2"}),"Cancel"]}),(0,r.Y)(o.$,{onClick:Q,disabled:D||!N,className:"bg-teal-600 hover:bg-teal-700 text-white",children:D?(0,r.FD)(r.FK,{children:[(0,r.Y)(b.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Processing..."]}):(0,r.FD)(r.FK,{children:[(0,r.Y)(I.A,{className:"h-4 w-4 mr-2"}),"Apply Changes"]})})]})]})})}let V=[{id:1,name:"OCF Team",slug:"ocf",color:"#14b8a6"},{id:2,name:"Legal",slug:"legal",color:"#3b82f6"},{id:3,name:"Advisors",slug:"advisors",color:"#8b5cf6"},{id:4,name:"Client Team",slug:"client",color:"#f59e0b"}],W={name:"",role:"",company:"",email:"",phone:"",mobile:"",location:"",linkedin_url:"",avatar_url:"",notes:"",category_id:1,project_id:null,is_primary:!1};function H(){let{user:e,loading:t,currentProject:a}=(0,l.A)(),{resolvedTheme:R}=(0,A.D)(),j=(0,D.useRouter)(),[_,S]=(0,s.useState)([]),[T,P]=(0,s.useState)(V),[J,E]=(0,s.useState)(!0),[z,L]=(0,s.useState)(!1),[U,M]=(0,s.useState)(null),[$,O]=(0,s.useState)(W),[I,G]=(0,s.useState)(!1),[H,K]=(0,s.useState)(null),[X,q]=(0,s.useState)(null),[Q,Z]=(0,s.useState)(!1),[ee,et]=(0,s.useState)(null),[ea,er]=(0,s.useState)(!1),[es,el]=(0,s.useState)(!1),en=(0,s.useRef)(null),ei=(null==e?void 0:e.role)==="admin",eo=(null==e?void 0:e.role)==="manager",ed=ei||eo;(0,s.useEffect)(()=>{if(!t){if(!ed)return void j.replace("/");ec(),em()}},[ed,t,j]);let ec=async()=>{try{let e=await fetch("/api/contacts.php"),t=await e.json();t.success&&S(t.data||[])}catch(e){console.error("Error fetching team members:",e),S([])}finally{E(!1)}},em=async()=>{try{var e;let t=await fetch("/api/contacts.php?action=categories"),a=await t.json();a.success&&(null==(e=a.data)?void 0:e.length)>0&&P(a.data)}catch(e){console.error("Error fetching categories:",e)}},eh=e=>{e?(M(e),O({name:e.name,role:e.role||"",company:e.company||"",email:e.email||"",phone:e.phone||"",mobile:e.mobile||"",location:e.location||"",linkedin_url:e.linkedin_url||"",avatar_url:e.avatar_url||"",notes:e.notes||"",category_id:e.category_id,project_id:e.project_id||null,is_primary:e.is_primary}),q(e.avatar_url||null)):(M(null),O(W),q(null)),K(null),L(!0)},eu=()=>{L(!1),M(null),O(W),K(null),q(null)},ep=e=>{K(e);let t=new FileReader;t.onloadend=()=>{et(t.result),Z(!0)},t.readAsDataURL(e)},ef=async e=>{el(!0);try{var t;let a=await fetch(e),r=await a.blob(),s=new FormData;s.append("image",r,"avatar.jpg");let l=await fetch("/api/upload.php",{method:"POST",body:s});if(!l.ok)throw Error("Upload failed: ".concat(l.status," ").concat(l.statusText));let n=await l.json();if(n.success&&(null==(t=n.data)?void 0:t.url))return n.data.url;throw Error(n.error||"Upload failed - no URL returned")}catch(e){throw console.error("Image upload error:",e),e}finally{el(!1)}},eg=async()=>{if(!$.name.trim())return void C.oR.error("Please enter a name");G(!0);try{let e,t=$.avatar_url;if(X&&X!==$.avatar_url)try{C.oR.loading("Uploading image...",{id:"upload"}),t=await ef(X),C.oR.success("Image uploaded",{id:"upload"})}catch(e){C.oR.error("Failed to upload image. Please try again.",{id:"upload"}),G(!1);return}let a={...$,avatar_url:t,is_primary:+!!$.is_primary};e=U?await fetch("/api/contacts.php?id=".concat(U.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}):await fetch("/api/contacts.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});let r=await e.json();r.success?(C.oR.success(U?"Team member updated":"Team member added"),eu(),ec()):C.oR.error(r.error||"Failed to save team member")}catch(e){console.error("Error saving team member:",e),C.oR.error("Failed to save team member")}finally{G(!1)}},eb=async e=>{if(confirm("Are you sure you want to delete this team member?"))try{let t=await fetch("/api/contacts.php?id=".concat(e),{method:"DELETE"}),a=await t.json();a.success?(C.oR.success("Team member deleted"),ec()):C.oR.error(a.error||"Failed to delete team member")}catch(e){console.error("Error deleting team member:",e),C.oR.error("Failed to delete team member")}},ex=e=>{switch(e){case"ocf":return"bg-teal-100 text-teal-700 dark:bg-teal-900/30 dark:text-teal-400";case"legal":return"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400";case"advisors":return"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400";case"client":return"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400";default:return"bg-stone-100 text-stone-700 dark:bg-stone-800 dark:text-stone-400"}},eN=e=>e.split(" ").map(e=>e[0]).join("").slice(0,2).toUpperCase();return t?(0,r.FD)(n.t,{children:[(0,r.Y)(C.l$,{position:"top-right",richColors:!0,theme:"dark"===R?"dark":"light"}),(0,r.Y)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,r.Y)(b.A,{className:"h-8 w-8 animate-spin text-teal-600"})})]}):ed?(0,r.FD)(n.t,{children:[(0,r.Y)(C.l$,{position:"top-right",richColors:!0,theme:"dark"===R?"dark":"light"}),(0,r.FD)("div",{className:"space-y-6",children:[(0,r.FD)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[(0,r.FD)("div",{children:[(0,r.FD)("h1",{className:"text-2xl font-bold text-stone-800 dark:text-white flex items-center gap-2",children:[(0,r.Y)(x.A,{className:"h-7 w-7 text-amber-500"}),"Manage Team Members"]}),(0,r.Y)("p",{className:"text-stone-500 dark:text-stone-400 mt-1",children:"Add, edit, and manage deal team contacts"})]}),(0,r.FD)(o.$,{className:"bg-teal-600 hover:bg-teal-700",onClick:()=>eh(),children:[(0,r.Y)(N.A,{className:"h-4 w-4 mr-2"}),"Add Team Member"]})]}),(0,r.FD)(i.Zp,{children:[(0,r.FD)(i.aR,{children:[(0,r.FD)(i.ZB,{className:"flex items-center gap-2",children:[(0,r.Y)(x.A,{className:"h-5 w-5"}),"Team Members"]}),(0,r.Y)(i.BT,{children:"All team members across categories"})]}),(0,r.Y)(i.Wu,{children:J?(0,r.Y)("div",{className:"flex items-center justify-center py-8",children:(0,r.Y)(b.A,{className:"h-6 w-6 animate-spin text-teal-600"})}):0===_.length?(0,r.FD)("div",{className:"text-center py-12",children:[(0,r.Y)(x.A,{className:"h-12 w-12 text-stone-300 dark:text-stone-600 mx-auto mb-4"}),(0,r.Y)("p",{className:"text-stone-500 dark:text-stone-400",children:"No team members yet"}),(0,r.Y)("p",{className:"text-sm text-stone-400 dark:text-stone-500 mt-1",children:'Click "Add Team Member" to create the first one'})]}):(0,r.FD)(g.XI,{children:[(0,r.Y)(g.A0,{children:(0,r.FD)(g.Hj,{children:[(0,r.Y)(g.nd,{children:"Member"}),(0,r.Y)(g.nd,{children:"Role / Company"}),(0,r.Y)(g.nd,{children:"Category"}),(0,r.Y)(g.nd,{children:"Contact"}),(0,r.Y)(g.nd,{className:"text-right",children:"Actions"})]})}),(0,r.Y)(g.BF,{children:_.map(e=>(0,r.FD)(g.Hj,{children:[(0,r.Y)(g.nA,{children:(0,r.FD)("div",{className:"flex items-center gap-3",children:[e.avatar_url?(0,r.Y)("img",{src:e.avatar_url,alt:e.name,className:"w-10 h-10 rounded-lg object-cover"}):(0,r.Y)("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-teal-500 to-teal-600 flex items-center justify-center",children:(0,r.Y)("span",{className:"text-white font-medium text-sm",children:eN(e.name)})}),(0,r.FD)("div",{children:[(0,r.FD)("div",{className:"flex items-center gap-2",children:[(0,r.Y)("p",{className:"font-medium",children:e.name}),e.is_primary&&(0,r.Y)(v.A,{className:"h-3.5 w-3.5 text-amber-500 fill-amber-500"})]}),e.location&&(0,r.Y)("p",{className:"text-xs text-stone-500",children:e.location})]})]})}),(0,r.FD)(g.nA,{children:[(0,r.Y)("p",{className:"font-medium text-sm",children:e.role||"-"}),(0,r.Y)("p",{className:"text-xs text-stone-500",children:e.company||"-"})]}),(0,r.Y)(g.nA,{children:(0,r.Y)(h.E,{className:ex(e.category_slug),children:e.category_name||"Uncategorized"})}),(0,r.Y)(g.nA,{children:(0,r.FD)("div",{className:"text-sm",children:[(0,r.Y)("p",{className:"text-stone-600 dark:text-stone-300",children:e.email||"-"}),(0,r.Y)("p",{className:"text-xs text-stone-500",children:e.phone||"-"})]})}),(0,r.Y)(g.nA,{className:"text-right",children:(0,r.FD)("div",{className:"flex justify-end gap-2",children:[(0,r.Y)(o.$,{variant:"outline",size:"sm",onClick:()=>eh(e),children:(0,r.Y)(y.A,{className:"h-4 w-4"})}),(0,r.Y)(o.$,{variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>eb(e.id),children:(0,r.Y)(w.A,{className:"h-4 w-4"})})]})})]},e.id))})]})})]}),(0,r.Y)(p.lG,{open:z,onOpenChange:L,children:(0,r.FD)(p.Cf,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto bg-white dark:bg-stone-900 border-stone-200 dark:border-stone-700",children:[(0,r.FD)(p.c7,{children:[(0,r.Y)(p.L3,{className:"text-stone-800 dark:text-white",children:U?"Edit Team Member":"Add Team Member"}),(0,r.Y)(p.rr,{className:"text-stone-500 dark:text-stone-400",children:U?"Update team member information":"Add a new team member to the deal team"})]}),(0,r.FD)("div",{className:"space-y-4 py-4",children:[(0,r.FD)("div",{className:"space-y-2",children:[(0,r.Y)(c.J,{className:"text-stone-700 dark:text-stone-300",children:"Photo / Logo"}),(0,r.Y)("div",{onDrop:e=>{e.preventDefault(),e.stopPropagation(),er(!1);let t=e.dataTransfer.files;if(t&&t.length>0){let e=t[0];e.type.startsWith("image/")?ep(e):C.oR.error("Please drop an image file (JPG, PNG, GIF, or WebP)")}},onDragOver:e=>{e.preventDefault(),e.stopPropagation()},onDragEnter:e=>{e.preventDefault(),e.stopPropagation(),er(!0)},onDragLeave:e=>{e.preventDefault(),e.stopPropagation(),er(!1)},className:"relative border-2 border-dashed rounded-xl p-4 transition-all ".concat(ea?"border-teal-500 bg-teal-50 dark:bg-teal-900/20":X?"border-teal-400 bg-teal-50/50 dark:bg-teal-900/10":"border-stone-300 dark:border-stone-600 hover:border-teal-400"),children:(0,r.FD)("div",{className:"flex items-center gap-4",children:[(0,r.Y)("div",{className:"w-20 h-20 rounded-xl flex items-center justify-center cursor-pointer overflow-hidden flex-shrink-0 ".concat(X?"":"bg-stone-100 dark:bg-stone-800"),onClick:()=>{var e;return null==(e=en.current)?void 0:e.click()},children:X?(0,r.Y)("img",{src:X,alt:"Preview",className:"w-full h-full object-cover"}):(0,r.Y)(Y.A,{className:"h-8 w-8 text-stone-400"})}),(0,r.FD)("div",{className:"flex-1 min-w-0",children:[(0,r.Y)("input",{ref:en,type:"file",accept:"image/*",className:"hidden",onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];a&&(a.type.startsWith("image/")?ep(a):C.oR.error("Please select an image file (JPG, PNG, GIF, or WebP)"))}}),(0,r.FD)("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:[(0,r.FD)(o.$,{type:"button",variant:"outline",size:"sm",onClick:()=>{var e;return null==(e=en.current)?void 0:e.click()},children:[(0,r.Y)(k.A,{className:"h-4 w-4 mr-2"}),X?"Change":"Browse"]}),X&&ee&&(0,r.FD)(o.$,{type:"button",variant:"outline",size:"sm",onClick:()=>Z(!0),className:"text-teal-600 border-teal-200 hover:bg-teal-50 dark:border-teal-800 dark:hover:bg-teal-900/30",children:[(0,r.Y)(Y.A,{className:"h-4 w-4 mr-1"}),"Edit"]}),X&&(0,r.Y)(o.$,{type:"button",variant:"ghost",size:"sm",className:"text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20",onClick:()=>{K(null),q(null),et(null),O({...$,avatar_url:""}),en.current&&(en.current.value="")},children:(0,r.Y)(F.A,{className:"h-4 w-4"})})]}),(0,r.Y)("p",{className:"text-xs text-stone-500 dark:text-stone-400",children:ea?(0,r.Y)("span",{className:"text-teal-600 font-medium",children:"Drop image here..."}):(0,r.Y)(r.FK,{children:"Drag & drop or click to upload. Supports JPG, PNG, GIF, WebP."})})]})]})})]}),(0,r.FD)("div",{className:"space-y-2",children:[(0,r.FD)(c.J,{htmlFor:"name",className:"text-stone-700 dark:text-stone-300",children:["Name ",(0,r.Y)("span",{className:"text-red-500",children:"*"})]}),(0,r.Y)(d.p,{id:"name",value:$.name,onChange:e=>O({...$,name:e.target.value}),placeholder:"John Smith",className:"bg-stone-50 dark:bg-stone-800 border-stone-200 dark:border-stone-700"})]}),(0,r.FD)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.FD)("div",{className:"space-y-2",children:[(0,r.Y)(c.J,{htmlFor:"role",className:"text-stone-700 dark:text-stone-300",children:"Role / Title"}),(0,r.Y)(d.p,{id:"role",value:$.role,onChange:e=>O({...$,role:e.target.value}),placeholder:"Deal Manager",className:"bg-stone-50 dark:bg-stone-800 border-stone-200 dark:border-stone-700"})]}),(0,r.FD)("div",{className:"space-y-2",children:[(0,r.Y)(c.J,{htmlFor:"company",className:"text-stone-700 dark:text-stone-300",children:"Company"}),(0,r.Y)(d.p,{id:"company",value:$.company,onChange:e=>O({...$,company:e.target.value}),placeholder:"Oasis Capital Finance",className:"bg-stone-50 dark:bg-stone-800 border-stone-200 dark:border-stone-700"})]})]}),(0,r.FD)("div",{className:"space-y-2",children:[(0,r.Y)(c.J,{htmlFor:"category",className:"text-stone-700 dark:text-stone-300",children:"Category"}),(0,r.FD)(f.l6,{value:String($.category_id),onValueChange:e=>O({...$,category_id:Number(e)}),children:[(0,r.Y)(f.bq,{className:"bg-stone-50 dark:bg-stone-800 border-stone-200 dark:border-stone-700",children:(0,r.Y)(f.yv,{placeholder:"Select category"})}),(0,r.Y)(f.gC,{className:"bg-white dark:bg-stone-800 border-stone-200 dark:border-stone-700",children:T.map(e=>(0,r.Y)(f.eb,{value:String(e.id),children:e.name},e.id))})]})]}),(0,r.FD)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.FD)("div",{className:"space-y-2",children:[(0,r.Y)(c.J,{htmlFor:"email",className:"text-stone-700 dark:text-stone-300",children:"Email"}),(0,r.Y)(d.p,{id:"email",type:"email",value:$.email,onChange:e=>O({...$,email:e.target.value}),placeholder:"john@company.com",className:"bg-stone-50 dark:bg-stone-800 border-stone-200 dark:border-stone-700"})]}),(0,r.FD)("div",{className:"space-y-2",children:[(0,r.Y)(c.J,{htmlFor:"phone",className:"text-stone-700 dark:text-stone-300",children:"Phone"}),(0,r.Y)(d.p,{id:"phone",value:$.phone,onChange:e=>O({...$,phone:e.target.value}),placeholder:"+44 20 7123 4567",className:"bg-stone-50 dark:bg-stone-800 border-stone-200 dark:border-stone-700"})]})]}),(0,r.FD)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.FD)("div",{className:"space-y-2",children:[(0,r.Y)(c.J,{htmlFor:"mobile",className:"text-stone-700 dark:text-stone-300",children:"Mobile"}),(0,r.Y)(d.p,{id:"mobile",value:$.mobile,onChange:e=>O({...$,mobile:e.target.value}),placeholder:"+44 7700 900123",className:"bg-stone-50 dark:bg-stone-800 border-stone-200 dark:border-stone-700"})]}),(0,r.FD)("div",{className:"space-y-2",children:[(0,r.Y)(c.J,{htmlFor:"location",className:"text-stone-700 dark:text-stone-300",children:"Location"}),(0,r.Y)(d.p,{id:"location",value:$.location,onChange:e=>O({...$,location:e.target.value}),placeholder:"London, UK",className:"bg-stone-50 dark:bg-stone-800 border-stone-200 dark:border-stone-700"})]})]}),(0,r.FD)("div",{className:"space-y-2",children:[(0,r.Y)(c.J,{htmlFor:"linkedin",className:"text-stone-700 dark:text-stone-300",children:"LinkedIn URL"}),(0,r.Y)(d.p,{id:"linkedin",value:$.linkedin_url,onChange:e=>O({...$,linkedin_url:e.target.value}),placeholder:"linkedin.com/in/johnsmith",className:"bg-stone-50 dark:bg-stone-800 border-stone-200 dark:border-stone-700"})]}),(0,r.FD)("div",{className:"space-y-2",children:[(0,r.Y)(c.J,{htmlFor:"notes",className:"text-stone-700 dark:text-stone-300",children:"Notes"}),(0,r.Y)(m.T,{id:"notes",value:$.notes,onChange:e=>O({...$,notes:e.target.value}),placeholder:"Additional notes about this team member...",rows:2,className:"bg-stone-50 dark:bg-stone-800 border-stone-200 dark:border-stone-700"})]}),(0,r.FD)("div",{className:"flex items-center space-x-2 pt-2",children:[(0,r.Y)(u.S,{id:"is_primary",checked:$.is_primary,onCheckedChange:e=>O({...$,is_primary:!0===e})}),(0,r.FD)(c.J,{htmlFor:"is_primary",className:"text-stone-700 dark:text-stone-300 cursor-pointer flex items-center gap-2",children:[(0,r.Y)(v.A,{className:"h-4 w-4 text-amber-500"}),"Primary Contact"]})]})]}),(0,r.FD)(p.Es,{children:[(0,r.Y)(o.$,{variant:"outline",onClick:eu,className:"border-stone-200 dark:border-stone-700",children:"Cancel"}),(0,r.Y)(o.$,{onClick:eg,disabled:!$.name.trim()||I,className:"bg-teal-600 hover:bg-teal-700 text-white",children:I?(0,r.FD)(r.FK,{children:[(0,r.Y)(b.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Saving..."]}):(0,r.FD)(r.FK,{children:[U?"Update":"Add"," Team Member"]})})]})]})}),ee&&(0,r.Y)(B,{open:Q,onOpenChange:e=>{Z(e),e||X||(K(null),et(null),en.current&&(en.current.value=""))},imageSrc:ee,onCropComplete:e=>{q(e),en.current&&(en.current.value="")},aspectRatio:1,circularCrop:!1,maxOutputSize:400,outputFormat:"image/jpeg",outputQuality:.9})]})]}):null}},9409:(e,t,a)=>{"use strict";a.d(t,{bq:()=>h,eb:()=>g,gC:()=>f,l6:()=>c,yv:()=>m});var r=a(2372),s=a(2115),l=a(3433),n=a(9556),i=a(7381),o=a(518),d=a(9434);let c=l.bL;l.YJ;let m=l.WT,h=s.forwardRef((e,t)=>{let{className:a,children:s,...i}=e;return(0,r.FD)(l.l9,{ref:t,className:(0,d.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...i,children:[s,(0,r.Y)(l.In,{asChild:!0,children:(0,r.Y)(n.A,{className:"h-4 w-4 opacity-50"})})]})});h.displayName=l.l9.displayName;let u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(l.PP,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.Y)(i.A,{className:"h-4 w-4"})})});u.displayName=l.PP.displayName;let p=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(l.wn,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.Y)(n.A,{className:"h-4 w-4"})})});p.displayName=l.wn.displayName;let f=s.forwardRef((e,t)=>{let{className:a,children:s,position:n="popper",...i}=e;return(0,r.Y)(l.ZL,{children:(0,r.FD)(l.UC,{ref:t,className:(0,d.cn)("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:n,...i,children:[(0,r.Y)(u,{}),(0,r.Y)(l.LM,{className:(0,d.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,r.Y)(p,{})]})})});f.displayName=l.UC.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(l.JU,{ref:t,className:(0,d.cn)("px-2 py-1.5 text-sm font-semibold",a),...s})}).displayName=l.JU.displayName;let g=s.forwardRef((e,t)=>{let{className:a,children:s,...n}=e;return(0,r.FD)(l.q7,{ref:t,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...n,children:[(0,r.Y)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.Y)(l.VF,{children:(0,r.Y)(o.A,{className:"h-4 w-4"})})}),(0,r.Y)(l.p4,{children:s})]})});g.displayName=l.q7.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(l.wv,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",a),...s})}).displayName=l.wv.displayName},9694:(e,t,a)=>{Promise.resolve().then(a.bind(a,9138))}},e=>{var t=t=>e(e.s=t);e.O(0,[111,372,9,726,434,671,440,485,924,190,441,684,358],()=>t(9694)),_N_E=e.O()}]);