(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{2523:(e,t,a)=>{"use strict";a.d(t,{p:()=>n});var r=a(2372),s=a(2115),l=a(9434);let n=s.forwardRef((e,t)=>{let{className:a,type:s,...n}=e;return(0,r.Y)("input",{type:s,className:(0,l.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...n})});n.displayName="Input"},5057:(e,t,a)=>{"use strict";a.d(t,{J:()=>c});var r=a(2372),s=a(2115),l=a(2797),n=a(2085),i=a(9434);let d=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(l.b,{ref:t,className:(0,i.cn)(d(),a),...s})});c.displayName=l.b.displayName},5400:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>C});var r=a(2372),s=a(2115),l=a(4541),n=a(4399),i=a(6695),d=a(285),c=a(2523),o=a(5057),m=a(8539),p=a(9409),h=a(6126),u=a(4165),f=a(3478),y=a(9556),N=a(9434);let x=f.bL,g=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(f.q7,{ref:t,className:(0,N.cn)("border-b",a),...s})});g.displayName="AccordionItem";let b=s.forwardRef((e,t)=>{let{className:a,children:s,...l}=e;return(0,r.Y)(f.Y9,{className:"flex",children:(0,r.FD)(f.l9,{ref:t,className:(0,N.cn)("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",a),...l,children:[s,(0,r.Y)(y.A,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})})});b.displayName=f.l9.displayName;let w=s.forwardRef((e,t)=>{let{className:a,children:s,...l}=e;return(0,r.Y)(f.UC,{ref:t,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...l,children:(0,r.Y)("div",{className:(0,N.cn)("pb-4 pt-0",a),children:s})})});w.displayName=f.UC.displayName;var v=a(172),Y=a(5844),F=a(4301),D=a(7223),k=a(7501),j=a(5695);function C(){let{user:e,loading:t}=(0,l.A)(),a=(0,j.useRouter)(),[f,y]=(0,s.useState)([]),[N,C]=(0,s.useState)(!0),[_,R]=(0,s.useState)(!1),[E,T]=(0,s.useState)({name:"",description:"",project_type:"general"}),A=(null==e?void 0:e.role)==="admin",q=(null==e?void 0:e.role)==="manager",P=A||q;(0,s.useEffect)(()=>{if(!t){if(!P)return void a.replace("/");J()}},[P,t,a]);let J=async()=>{try{let e=await fetch("/api/templates.php"),t=await e.json();if(t.success){let e=await Promise.all((t.data||[]).map(async e=>{try{let t=await fetch("/api/templates.php?id=".concat(e.id,"&tasks=1")),a=await t.json();return{...e,tasks:a.success?a.data:[],task_count:a.success?a.data.length:0}}catch(t){return{...e,tasks:[],task_count:0}}}));y(e)}}catch(e){console.error("Error fetching templates:",e)}finally{C(!1)}},S=async()=>{try{let e=await fetch("/api/templates.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:E.name,description:E.description,project_type:E.project_type})}),t=await e.json();t.success?(R(!1),T({name:"",description:"",project_type:"general"}),J()):alert("Error creating template: "+t.error)}catch(e){console.error("Error creating template:",e),alert("Error creating template")}},L=async e=>{if(confirm("Are you sure you want to delete this template?"))try{let t=await fetch("/api/templates.php?id=".concat(e),{method:"DELETE"}),a=await t.json();a.success?J():alert("Error deleting template: "+a.error)}catch(e){console.error("Error deleting template:",e)}};return t?(0,r.Y)(n.t,{children:(0,r.Y)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,r.Y)(v.A,{className:"h-8 w-8 animate-spin text-teal-600"})})}):P?(0,r.Y)(n.t,{children:(0,r.FD)("div",{className:"space-y-6",children:[(0,r.FD)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[(0,r.FD)("div",{children:[(0,r.FD)("h1",{className:"text-2xl font-bold text-stone-800 dark:text-white flex items-center gap-2",children:[(0,r.Y)(Y.A,{className:"h-7 w-7 text-amber-500"}),"Project Templates"]}),(0,r.Y)("p",{className:"text-stone-500 dark:text-stone-400 mt-1",children:"Create and manage reusable project templates"})]}),(0,r.FD)(u.lG,{open:_,onOpenChange:R,children:[(0,r.Y)(u.zM,{asChild:!0,children:(0,r.FD)(d.$,{className:"bg-teal-600 hover:bg-teal-700",children:[(0,r.Y)(F.A,{className:"h-4 w-4 mr-2"}),"Create Template"]})}),(0,r.FD)(u.Cf,{className:"sm:max-w-[500px]",children:[(0,r.FD)(u.c7,{children:[(0,r.Y)(u.L3,{children:"Create New Template"}),(0,r.Y)(u.rr,{children:"Create a template that can be used to quickly set up new projects."})]}),(0,r.FD)("div",{className:"space-y-4 py-4",children:[(0,r.FD)("div",{className:"space-y-2",children:[(0,r.Y)(o.J,{htmlFor:"name",children:"Template Name"}),(0,r.Y)(c.p,{id:"name",value:E.name,onChange:e=>T({...E,name:e.target.value}),placeholder:"e.g., Bond Issuance Template"})]}),(0,r.FD)("div",{className:"space-y-2",children:[(0,r.Y)(o.J,{htmlFor:"description",children:"Description"}),(0,r.Y)(m.T,{id:"description",value:E.description,onChange:e=>T({...E,description:e.target.value}),placeholder:"Describe when to use this template...",rows:3})]}),(0,r.FD)("div",{className:"space-y-2",children:[(0,r.Y)(o.J,{htmlFor:"project_type",children:"Project Type"}),(0,r.FD)(p.l6,{value:E.project_type,onValueChange:e=>T({...E,project_type:e}),children:[(0,r.Y)(p.bq,{children:(0,r.Y)(p.yv,{placeholder:"Select project type"})}),(0,r.FD)(p.gC,{children:[(0,r.Y)(p.eb,{value:"general",children:"General"}),(0,r.Y)(p.eb,{value:"bond_issuance",children:"Bond Issuance"}),(0,r.Y)(p.eb,{value:"equity_raise",children:"Equity Raise"}),(0,r.Y)(p.eb,{value:"merger_acquisition",children:"Merger & Acquisition"}),(0,r.Y)(p.eb,{value:"ipo",children:"IPO"}),(0,r.Y)(p.eb,{value:"restructuring",children:"Restructuring"}),(0,r.Y)(p.eb,{value:"refinancing",children:"Refinancing"})]})]})]})]}),(0,r.FD)("div",{className:"flex justify-end gap-2",children:[(0,r.Y)(d.$,{variant:"outline",onClick:()=>R(!1),children:"Cancel"}),(0,r.Y)(d.$,{onClick:S,disabled:!E.name.trim(),className:"bg-teal-600 hover:bg-teal-700",children:"Create Template"})]})]})]})]}),N?(0,r.Y)("div",{className:"text-center py-12 text-stone-500",children:"Loading templates..."}):0===f.length?(0,r.Y)(i.Zp,{children:(0,r.FD)(i.Wu,{className:"py-12 text-center",children:[(0,r.Y)(Y.A,{className:"h-12 w-12 mx-auto text-stone-300 dark:text-stone-600 mb-4"}),(0,r.Y)("h3",{className:"text-lg font-medium text-stone-700 dark:text-stone-300",children:"No templates yet"}),(0,r.Y)("p",{className:"text-stone-500 mt-1",children:"Create your first template to get started."})]})}):(0,r.Y)("div",{className:"space-y-4",children:f.map(e=>(0,r.FD)(i.Zp,{children:[(0,r.Y)(i.aR,{className:"pb-2",children:(0,r.FD)("div",{className:"flex items-start justify-between",children:[(0,r.FD)("div",{className:"flex-1",children:[(0,r.FD)(i.ZB,{className:"text-lg flex items-center gap-2",children:[e.name,(0,r.FD)(h.E,{variant:"outline",className:"ml-2",children:[e.task_count||0," tasks"]})]}),(0,r.Y)(i.BT,{className:"mt-1",children:e.description||"No description"})]}),(0,r.Y)("div",{className:"flex gap-2",children:(0,r.Y)(d.$,{variant:"outline",size:"sm",onClick:()=>L(e.id),className:"text-red-600 hover:text-red-700",children:(0,r.Y)(D.A,{className:"h-4 w-4"})})})]})}),(0,r.Y)(i.Wu,{children:e.tasks&&e.tasks.length>0&&(0,r.Y)(x,{type:"single",collapsible:!0,children:(0,r.FD)(g,{value:"tasks",className:"border-none",children:[(0,r.Y)(b,{className:"py-2 text-sm text-stone-600 dark:text-stone-400 hover:no-underline",children:(0,r.FD)("span",{className:"flex items-center gap-2",children:[(0,r.Y)(k.A,{className:"h-4 w-4"}),"View Tasks (",e.tasks.length,")"]})}),(0,r.Y)(w,{children:(0,r.Y)("div",{className:"space-y-2 pt-2",children:e.tasks.map((e,t)=>(0,r.FD)("div",{className:"flex items-center gap-3 p-2 rounded-lg bg-stone-50 dark:bg-stone-800/50",children:[(0,r.FD)("span",{className:"text-xs text-stone-400 w-6",children:[t+1,"."]}),(0,r.FD)("div",{className:"flex-1",children:[(0,r.Y)("p",{className:"text-sm font-medium",children:e.name}),(0,r.FD)("p",{className:"text-xs text-stone-500",children:[e.duration_days," days • Starts day ",e.offset_days,e.is_milestone&&" • Milestone"]})]}),e.is_milestone&&(0,r.Y)(h.E,{className:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400",children:"Milestone"})]},e.id))})})]})})})]},e.id))})]})}):null}},8503:(e,t,a)=>{Promise.resolve().then(a.bind(a,5400))},8539:(e,t,a)=>{"use strict";a.d(t,{T:()=>n});var r=a(2372),s=a(2115),l=a(9434);let n=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)("textarea",{className:(0,l.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...s})});n.displayName="Textarea"},9409:(e,t,a)=>{"use strict";a.d(t,{bq:()=>p,eb:()=>y,gC:()=>f,l6:()=>o,yv:()=>m});var r=a(2372),s=a(2115),l=a(3433),n=a(9556),i=a(7381),d=a(518),c=a(9434);let o=l.bL;l.YJ;let m=l.WT,p=s.forwardRef((e,t)=>{let{className:a,children:s,...i}=e;return(0,r.FD)(l.l9,{ref:t,className:(0,c.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...i,children:[s,(0,r.Y)(l.In,{asChild:!0,children:(0,r.Y)(n.A,{className:"h-4 w-4 opacity-50"})})]})});p.displayName=l.l9.displayName;let h=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(l.PP,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.Y)(i.A,{className:"h-4 w-4"})})});h.displayName=l.PP.displayName;let u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(l.wn,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.Y)(n.A,{className:"h-4 w-4"})})});u.displayName=l.wn.displayName;let f=s.forwardRef((e,t)=>{let{className:a,children:s,position:n="popper",...i}=e;return(0,r.Y)(l.ZL,{children:(0,r.FD)(l.UC,{ref:t,className:(0,c.cn)("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:n,...i,children:[(0,r.Y)(h,{}),(0,r.Y)(l.LM,{className:(0,c.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,r.Y)(u,{})]})})});f.displayName=l.UC.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(l.JU,{ref:t,className:(0,c.cn)("px-2 py-1.5 text-sm font-semibold",a),...s})}).displayName=l.JU.displayName;let y=s.forwardRef((e,t)=>{let{className:a,children:s,...n}=e;return(0,r.FD)(l.q7,{ref:t,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...n,children:[(0,r.Y)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.Y)(l.VF,{children:(0,r.Y)(d.A,{className:"h-4 w-4"})})}),(0,r.Y)(l.p4,{children:s})]})});y.displayName=l.q7.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)(l.wv,{ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",a),...s})}).displayName=l.wv.displayName}},e=>{var t=t=>e(e.s=t);e.O(0,[372,9,726,434,883,924,190,441,684,358],()=>t(8503)),_N_E=e.O()}]);