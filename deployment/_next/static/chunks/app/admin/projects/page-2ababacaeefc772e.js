(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[321],{172:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(157).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},1920:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(157).A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},2399:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>v});var r=a(2372),l=a(2115),s=a(4541),i=a(4399),n=a(6695),d=a(285),c=a(2523),o=a(5057),m=a(8539),p=a(6126),h=a(4165),u=a(9409),f=a(172),y=a(1794),g=a(4301),x=a(1920),b=a(7607),w=a(7223),N=a(5695);function v(){let{user:e,loading:t}=(0,s.A)(),a=(0,N.useRouter)(),[v,Y]=(0,l.useState)([]),[k,j]=(0,l.useState)([]),[D,_]=(0,l.useState)(!0),[F,C]=(0,l.useState)(!1),[A,E]=(0,l.useState)({name:"",description:"",template_id:"",start_date:new Date().toISOString().split("T")[0]}),S=(null==e?void 0:e.role)==="admin",M=(null==e?void 0:e.role)==="manager",P=S||M;(0,l.useEffect)(()=>{if(!t){if(!P)return void a.replace("/");R(),T()}},[P,t,a]);let R=async()=>{try{let e=await fetch("/api/projects.php"),t=await e.json();t.success&&Y(t.data||[])}catch(e){console.error("Error fetching projects:",e)}finally{_(!1)}},T=async()=>{try{let e=await fetch("/api/templates.php"),t=await e.json();t.success&&j(t.data||[])}catch(e){console.error("Error fetching templates:",e)}},L=async()=>{try{let e=await fetch("/api/projects.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:A.name,description:A.description,template_id:A.template_id?Number(A.template_id):null,start_date:A.start_date})}),t=await e.json();t.success?(C(!1),E({name:"",description:"",template_id:"",start_date:new Date().toISOString().split("T")[0]}),R()):alert("Error creating project: "+t.error)}catch(e){console.error("Error creating project:",e),alert("Error creating project")}},J=async e=>{if(confirm("Are you sure you want to delete this project? This cannot be undone."))try{let t=await fetch("/api/projects.php?id=".concat(e),{method:"DELETE"}),a=await t.json();a.success?R():alert("Error deleting project: "+a.error)}catch(e){console.error("Error deleting project:",e)}};if(t)return(0,r.Y)(i.t,{children:(0,r.Y)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,r.Y)(f.A,{className:"h-8 w-8 animate-spin text-teal-600"})})});if(!P)return null;let z=e=>{switch(e){case"active":return"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400";case"completed":return"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400";case"on-hold":return"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400";default:return"bg-stone-100 text-stone-700 dark:bg-stone-800 dark:text-stone-400"}};return(0,r.Y)(i.t,{children:(0,r.FD)("div",{className:"space-y-6",children:[(0,r.FD)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[(0,r.FD)("div",{children:[(0,r.FD)("h1",{className:"text-2xl font-bold text-stone-800 dark:text-white flex items-center gap-2",children:[(0,r.Y)(y.A,{className:"h-7 w-7 text-amber-500"}),"Manage Projects"]}),(0,r.Y)("p",{className:"text-stone-500 dark:text-stone-400 mt-1",children:"Create, edit, and manage all projects"})]}),(0,r.FD)(h.lG,{open:F,onOpenChange:C,children:[(0,r.Y)(h.zM,{asChild:!0,children:(0,r.FD)(d.$,{className:"bg-teal-600 hover:bg-teal-700",children:[(0,r.Y)(g.A,{className:"h-4 w-4 mr-2"}),"Create Project"]})}),(0,r.FD)(h.Cf,{className:"sm:max-w-[500px]",children:[(0,r.FD)(h.c7,{children:[(0,r.Y)(h.L3,{children:"Create New Project"}),(0,r.Y)(h.rr,{children:"Create a new project from scratch or use a template."})]}),(0,r.FD)("div",{className:"space-y-4 py-4",children:[(0,r.FD)("div",{className:"space-y-2",children:[(0,r.Y)(o.J,{htmlFor:"name",children:"Project Name"}),(0,r.Y)(c.p,{id:"name",value:A.name,onChange:e=>E({...A,name:e.target.value}),placeholder:"e.g., Nordic Bond Issuance 2026"})]}),(0,r.FD)("div",{className:"space-y-2",children:[(0,r.Y)(o.J,{htmlFor:"description",children:"Description"}),(0,r.Y)(m.T,{id:"description",value:A.description,onChange:e=>E({...A,description:e.target.value}),placeholder:"Brief description of the project...",rows:3})]}),(0,r.FD)("div",{className:"space-y-2",children:[(0,r.Y)(o.J,{htmlFor:"template",children:"Use Template (Optional)"}),(0,r.FD)(u.l6,{value:A.template_id||"__none__",onValueChange:e=>E({...A,template_id:"__none__"===e?"":e}),children:[(0,r.Y)(u.bq,{children:(0,r.Y)(u.yv,{placeholder:"Select a template..."})}),(0,r.FD)(u.gC,{children:[(0,r.Y)(u.eb,{value:"__none__",children:"No template"}),k.map(e=>(0,r.Y)(u.eb,{value:String(e.id),children:e.name},e.id))]})]})]}),(0,r.FD)("div",{className:"space-y-2",children:[(0,r.Y)(o.J,{htmlFor:"start_date",children:"Start Date"}),(0,r.Y)(c.p,{id:"start_date",type:"date",value:A.start_date,onChange:e=>E({...A,start_date:e.target.value})})]})]}),(0,r.FD)("div",{className:"flex justify-end gap-2",children:[(0,r.Y)(d.$,{variant:"outline",onClick:()=>C(!1),children:"Cancel"}),(0,r.Y)(d.$,{onClick:L,disabled:!A.name.trim(),className:"bg-teal-600 hover:bg-teal-700",children:"Create Project"})]})]})]})]}),D?(0,r.Y)("div",{className:"text-center py-12 text-stone-500",children:"Loading projects..."}):0===v.length?(0,r.Y)(n.Zp,{children:(0,r.FD)(n.Wu,{className:"py-12 text-center",children:[(0,r.Y)(y.A,{className:"h-12 w-12 mx-auto text-stone-300 dark:text-stone-600 mb-4"}),(0,r.Y)("h3",{className:"text-lg font-medium text-stone-700 dark:text-stone-300",children:"No projects yet"}),(0,r.Y)("p",{className:"text-stone-500 mt-1",children:"Create your first project to get started."})]})}):(0,r.Y)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:v.map(e=>(0,r.FD)(n.Zp,{className:"hover:shadow-md transition-shadow",children:[(0,r.Y)(n.aR,{className:"pb-2",children:(0,r.FD)("div",{className:"flex items-start justify-between",children:[(0,r.FD)("div",{className:"flex-1",children:[(0,r.Y)(n.ZB,{className:"text-lg",children:e.name}),(0,r.Y)(n.BT,{className:"line-clamp-2 mt-1",children:e.description||"No description"})]}),(0,r.Y)(p.E,{className:z(e.status),children:e.status})]})}),(0,r.FD)(n.Wu,{children:[(0,r.Y)("div",{className:"flex items-center gap-4 text-sm text-stone-500 dark:text-stone-400 mb-4",children:(0,r.FD)("span",{className:"flex items-center gap-1",children:[(0,r.Y)(x.A,{className:"h-4 w-4"}),new Date(e.start_date).toLocaleDateString()]})}),(0,r.FD)("div",{className:"flex gap-2",children:[(0,r.FD)(d.$,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>a.push("/timeline?project=".concat(e.id)),children:[(0,r.Y)(b.A,{className:"h-4 w-4 mr-1"}),"View"]}),S&&(0,r.Y)(d.$,{variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>J(e.id),children:(0,r.Y)(w.A,{className:"h-4 w-4"})})]})]})]},e.id))})]})})}},2523:(e,t,a)=>{"use strict";a.d(t,{p:()=>i});var r=a(2372),l=a(2115),s=a(9434);let i=l.forwardRef((e,t)=>{let{className:a,type:l,...i}=e;return(0,r.Y)("input",{type:l,className:(0,s.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...i})});i.displayName="Input"},2797:(e,t,a)=>{"use strict";a.d(t,{b:()=>d});var r=a(2115);a(7650);var l=a(9708),s=a(5155),i=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let a=(0,l.TL)(`Primitive.${t}`),i=r.forwardRef((e,r)=>{let{asChild:l,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,s.jsx)(l?a:t,{...i,ref:r})});return i.displayName=`Primitive.${t}`,{...e,[t]:i}},{}),n=r.forwardRef((e,t)=>(0,s.jsx)(i.label,{...e,ref:t,onMouseDown:t=>{var a;t.target.closest("button, input, select, textarea")||(null==(a=e.onMouseDown)||a.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));n.displayName="Label";var d=n},4301:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(157).A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},5057:(e,t,a)=>{"use strict";a.d(t,{J:()=>c});var r=a(2372),l=a(2115),s=a(2797),i=a(2085),n=a(9434);let d=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,r.Y)(s.b,{ref:t,className:(0,n.cn)(d(),a),...l})});c.displayName=s.b.displayName},7223:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(157).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},7607:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(157).A)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},8539:(e,t,a)=>{"use strict";a.d(t,{T:()=>i});var r=a(2372),l=a(2115),s=a(9434);let i=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,r.Y)("textarea",{className:(0,s.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...l})});i.displayName="Textarea"},9028:(e,t,a)=>{Promise.resolve().then(a.bind(a,2399))},9409:(e,t,a)=>{"use strict";a.d(t,{bq:()=>p,eb:()=>y,gC:()=>f,l6:()=>o,yv:()=>m});var r=a(2372),l=a(2115),s=a(3433),i=a(9556),n=a(7381),d=a(518),c=a(9434);let o=s.bL;s.YJ;let m=s.WT,p=l.forwardRef((e,t)=>{let{className:a,children:l,...n}=e;return(0,r.FD)(s.l9,{ref:t,className:(0,c.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...n,children:[l,(0,r.Y)(s.In,{asChild:!0,children:(0,r.Y)(i.A,{className:"h-4 w-4 opacity-50"})})]})});p.displayName=s.l9.displayName;let h=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,r.Y)(s.PP,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",a),...l,children:(0,r.Y)(n.A,{className:"h-4 w-4"})})});h.displayName=s.PP.displayName;let u=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,r.Y)(s.wn,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",a),...l,children:(0,r.Y)(i.A,{className:"h-4 w-4"})})});u.displayName=s.wn.displayName;let f=l.forwardRef((e,t)=>{let{className:a,children:l,position:i="popper",...n}=e;return(0,r.Y)(s.ZL,{children:(0,r.FD)(s.UC,{ref:t,className:(0,c.cn)("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:i,...n,children:[(0,r.Y)(h,{}),(0,r.Y)(s.LM,{className:(0,c.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:l}),(0,r.Y)(u,{})]})})});f.displayName=s.UC.displayName,l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,r.Y)(s.JU,{ref:t,className:(0,c.cn)("px-2 py-1.5 text-sm font-semibold",a),...l})}).displayName=s.JU.displayName;let y=l.forwardRef((e,t)=>{let{className:a,children:l,...i}=e;return(0,r.FD)(s.q7,{ref:t,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...i,children:[(0,r.Y)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.Y)(s.VF,{children:(0,r.Y)(d.A,{className:"h-4 w-4"})})}),(0,r.Y)(s.p4,{children:l})]})});y.displayName=s.q7.displayName,l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,r.Y)(s.wv,{ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",a),...l})}).displayName=s.wv.displayName}},e=>{var t=t=>e(e.s=t);e.O(0,[372,9,726,434,924,190,441,684,358],()=>t(9028)),_N_E=e.O()}]);