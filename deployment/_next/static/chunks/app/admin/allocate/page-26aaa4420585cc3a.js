(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[196],{172:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});let l=(0,a(157).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},1347:(e,t,a)=>{Promise.resolve().then(a.bind(a,1734))},1734:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>g});var l=a(2372),r=a(2115),n=a(4541),s=a(4399),c=a(6695),i=a(285),d=a(6126),o=a(9409),m=a(5127),h=a(172),p=a(3896),u=a(3173),f=a(1794),b=a(518),N=a(286),x=a(5695);let Y=[{id:"client-1",name:"Acme Corporation",email:"contact@acmecorp.com",company:"Acme Corporation"},{id:"client-2",name:"Global Investments Ltd",email:"info@globalinvest.com",company:"Global Investments Ltd"},{id:"client-3",name:"Tech Ventures Inc",email:"hello@techventures.com",company:"Tech Ventures Inc"}];function g(){let{user:e,loading:t}=(0,n.A)(),a=(0,x.useRouter)(),[g,y]=(0,r.useState)([]),[w,v]=(0,r.useState)(!0),[A,F]=(0,r.useState)({}),j=(null==e?void 0:e.role)==="admin";(0,r.useEffect)(()=>{if(!t){if(!j)return void a.replace("/");D()}},[j,t,a]);let D=async()=>{try{let e=await fetch("/api/projects.php"),t=await e.json();if(t.success){y(t.data||[]);let e={};(t.data||[]).forEach(t=>{t.client_id&&(e[t.id]=String(t.client_id))}),F(e)}}catch(e){console.error("Error fetching projects:",e)}finally{v(!1)}},_=(e,t)=>{F(a=>({...a,[e]:t}))},C=async e=>{let t=A[e];try{let a=await fetch("/api/projects.php?id=".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:t||null})}),l=await a.json();l.success?(alert("Allocation saved successfully!"),D()):alert("Error saving allocation: "+l.error)}catch(e){console.error("Error saving allocation:",e),alert("Error saving allocation")}};return t?(0,l.Y)(s.t,{children:(0,l.Y)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,l.Y)(h.A,{className:"h-8 w-8 animate-spin text-teal-600"})})}):j?(0,l.Y)(s.t,{children:(0,l.FD)("div",{className:"space-y-6",children:[(0,l.FD)("div",{children:[(0,l.FD)("h1",{className:"text-2xl font-bold text-stone-800 dark:text-white flex items-center gap-2",children:[(0,l.Y)(p.A,{className:"h-7 w-7 text-amber-500"}),"Allocate Projects to Clients"]}),(0,l.Y)("p",{className:"text-stone-500 dark:text-stone-400 mt-1",children:"Assign projects to client accounts for their portal access"})]}),(0,l.Y)(c.Zp,{className:"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800",children:(0,l.Y)(c.Wu,{className:"py-4",children:(0,l.FD)("div",{className:"flex items-start gap-3",children:[(0,l.Y)(u.A,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mt-0.5"}),(0,l.FD)("div",{children:[(0,l.Y)("p",{className:"font-medium text-blue-800 dark:text-blue-300",children:"Client Portal Access"}),(0,l.Y)("p",{className:"text-sm text-blue-600 dark:text-blue-400 mt-1",children:"When you allocate a project to a client, they will be able to see the project in their portal, including the timeline, documents, and team contacts."})]})]})})}),(0,l.FD)(c.Zp,{children:[(0,l.FD)(c.aR,{children:[(0,l.FD)(c.ZB,{className:"flex items-center gap-2",children:[(0,l.Y)(f.A,{className:"h-5 w-5"}),"Project Allocations"]}),(0,l.Y)(c.BT,{children:"Select a client for each project to grant them access"})]}),(0,l.Y)(c.Wu,{children:w?(0,l.Y)("div",{className:"text-center py-8 text-stone-500",children:"Loading projects..."}):0===g.length?(0,l.Y)("div",{className:"text-center py-8 text-stone-500",children:"No projects available. Create a project first."}):(0,l.FD)(m.XI,{children:[(0,l.Y)(m.A0,{children:(0,l.FD)(m.Hj,{children:[(0,l.Y)(m.nd,{children:"Project"}),(0,l.Y)(m.nd,{children:"Status"}),(0,l.Y)(m.nd,{children:"Allocated Client"}),(0,l.Y)(m.nd,{className:"text-right",children:"Action"})]})}),(0,l.Y)(m.BF,{children:g.map(e=>(0,l.FD)(m.Hj,{children:[(0,l.Y)(m.nA,{children:(0,l.FD)("div",{children:[(0,l.Y)("p",{className:"font-medium",children:e.name}),(0,l.Y)("p",{className:"text-sm text-stone-500 line-clamp-1",children:e.description||"No description"})]})}),(0,l.Y)(m.nA,{children:(0,l.Y)(d.E,{variant:"outline",className:"capitalize",children:e.status})}),(0,l.Y)(m.nA,{children:(0,l.FD)(o.l6,{value:A[e.id]||"__unallocated__",onValueChange:t=>_(e.id,"__unallocated__"===t?"":t),children:[(0,l.Y)(o.bq,{className:"w-[200px]",children:(0,l.Y)(o.yv,{placeholder:"Select client..."})}),(0,l.FD)(o.gC,{children:[(0,l.Y)(o.eb,{value:"__unallocated__",children:"No client (Unallocated)"}),Y.map(e=>(0,l.Y)(o.eb,{value:e.id,children:e.name},e.id))]})]})}),(0,l.Y)(m.nA,{className:"text-right",children:(0,l.FD)(i.$,{size:"sm",onClick:()=>C(e.id),className:"bg-teal-600 hover:bg-teal-700",children:[(0,l.Y)(b.A,{className:"h-4 w-4 mr-1"}),"Save"]})})]},e.id))})]})})]}),(0,l.FD)(c.Zp,{children:[(0,l.FD)(c.aR,{children:[(0,l.FD)(c.ZB,{className:"flex items-center gap-2",children:[(0,l.Y)(N.A,{className:"h-5 w-5"}),"Available Clients"]}),(0,l.Y)(c.BT,{children:"Client accounts that can be allocated to projects"})]}),(0,l.Y)(c.Wu,{children:(0,l.Y)("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:Y.map(e=>(0,l.FD)("div",{className:"flex items-center gap-3 p-3 rounded-lg border border-stone-200 dark:border-stone-700",children:[(0,l.Y)("div",{className:"w-10 h-10 rounded-full bg-amber-100 dark:bg-amber-900/30 flex items-center justify-center",children:(0,l.Y)(u.A,{className:"h-5 w-5 text-amber-600 dark:text-amber-400"})}),(0,l.FD)("div",{className:"flex-1 min-w-0",children:[(0,l.Y)("p",{className:"font-medium text-stone-800 dark:text-stone-200 truncate",children:e.name}),(0,l.Y)("p",{className:"text-sm text-stone-500 truncate",children:e.email})]})]},e.id))})})]})]})}):null}},5127:(e,t,a)=>{"use strict";a.d(t,{A0:()=>c,BF:()=>i,Hj:()=>d,XI:()=>s,nA:()=>m,nd:()=>o});var l=a(2372),r=a(2115),n=a(9434);let s=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.Y)("div",{className:"relative w-full overflow-auto",children:(0,l.Y)("table",{ref:t,className:(0,n.cn)("w-full caption-bottom text-sm",a),...r})})});s.displayName="Table";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.Y)("thead",{ref:t,className:(0,n.cn)("[&_tr]:border-b",a),...r})});c.displayName="TableHeader";let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.Y)("tbody",{ref:t,className:(0,n.cn)("[&_tr:last-child]:border-0",a),...r})});i.displayName="TableBody",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.Y)("tfoot",{ref:t,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...r})}).displayName="TableFooter";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.Y)("tr",{ref:t,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...r})});d.displayName="TableRow";let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.Y)("th",{ref:t,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...r})});o.displayName="TableHead";let m=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.Y)("td",{ref:t,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...r})});m.displayName="TableCell",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.Y)("caption",{ref:t,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",a),...r})}).displayName="TableCaption"},9409:(e,t,a)=>{"use strict";a.d(t,{bq:()=>h,eb:()=>b,gC:()=>f,l6:()=>o,yv:()=>m});var l=a(2372),r=a(2115),n=a(3433),s=a(9556),c=a(7381),i=a(518),d=a(9434);let o=n.bL;n.YJ;let m=n.WT,h=r.forwardRef((e,t)=>{let{className:a,children:r,...c}=e;return(0,l.FD)(n.l9,{ref:t,className:(0,d.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...c,children:[r,(0,l.Y)(n.In,{asChild:!0,children:(0,l.Y)(s.A,{className:"h-4 w-4 opacity-50"})})]})});h.displayName=n.l9.displayName;let p=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.Y)(n.PP,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,l.Y)(c.A,{className:"h-4 w-4"})})});p.displayName=n.PP.displayName;let u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.Y)(n.wn,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,l.Y)(s.A,{className:"h-4 w-4"})})});u.displayName=n.wn.displayName;let f=r.forwardRef((e,t)=>{let{className:a,children:r,position:s="popper",...c}=e;return(0,l.Y)(n.ZL,{children:(0,l.FD)(n.UC,{ref:t,className:(0,d.cn)("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]","popper"===s&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:s,...c,children:[(0,l.Y)(p,{}),(0,l.Y)(n.LM,{className:(0,d.cn)("p-1","popper"===s&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,l.Y)(u,{})]})})});f.displayName=n.UC.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.Y)(n.JU,{ref:t,className:(0,d.cn)("px-2 py-1.5 text-sm font-semibold",a),...r})}).displayName=n.JU.displayName;let b=r.forwardRef((e,t)=>{let{className:a,children:r,...s}=e;return(0,l.FD)(n.q7,{ref:t,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...s,children:[(0,l.Y)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,l.Y)(n.VF,{children:(0,l.Y)(i.A,{className:"h-4 w-4"})})}),(0,l.Y)(n.p4,{children:r})]})});b.displayName=n.q7.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.Y)(n.wv,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",a),...r})}).displayName=n.wv.displayName}},e=>{var t=t=>e(e.s=t);e.O(0,[372,9,726,434,924,190,441,684,358],()=>t(1347)),_N_E=e.O()}]);